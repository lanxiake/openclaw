# OpenClaw AI 个人助理平台 - 开发实施计划

> 版本: 1.0 | 创建日期: 2026-02-08 | 状态: 整合版
>
> 本文档整合所有开发计划和任务跟踪

---

## 修订记录

| 版本 | 日期       | 修订内容                                                             |
| ---- | ---------- | -------------------------------------------------------------------- |
| 1.0  | 2026-02-08 | 整合 04-实施计划文档、10-服务端管理后台开发计划、11-功能补全开发计划 |

---

## 1. 项目概述

### 1.1 开发范围

| 模块           | 说明                   | 状态      |
| -------------- | ---------------------- | --------- |
| Windows 客户端 | Electron 桌面应用      | ✅ 已完成 |
| Gateway 扩展   | assistant.\* RPC 方法  | ✅ 已完成 |
| 技能系统       | 技能加载、执行、商店   | ✅ 已完成 |
| 订阅系统       | 订阅计划、计费         | ✅ 已完成 |
| 支付系统       | 支付对接               | ✅ 已完成 |
| Admin Console  | 服务端管理后台         | ✅ 已完成 |
| 用户认证       | Windows 客户端登录界面 | ⏳ 待开发 |
| 技能数据库     | 技能真实数据存储       | ⏳ 待开发 |
| 系统监控       | 真实监控数据           | ⏳ 待开发 |

### 1.2 架构复用分析

| 能力         | 现有实现                  | 复用价值                |
| ------------ | ------------------------- | ----------------------- |
| Gateway 服务 | `src/gateway/`            | ⭐⭐⭐⭐⭐ 直接复用     |
| 通信协议     | TypeBox schema + JSON-RPC | ⭐⭐⭐⭐⭐ 直接复用     |
| 插件系统     | `src/plugins/`            | ⭐⭐⭐⭐⭐ 技能系统基础 |
| AI 代理      | Pi Agent Core 集成        | ⭐⭐⭐⭐⭐ 直接复用     |
| 配置系统     | YAML + Zod 验证           | ⭐⭐⭐⭐⭐ 直接复用     |
| 认证机制     | 设备配对 + JWT Token      | ⭐⭐⭐⭐⭐ 直接复用     |
| 工具系统     | `src/agents/tools/`       | ⭐⭐⭐⭐⭐ 扩展复用     |

---

## 2. 已完成开发任务

### 2.1 Phase 1: 基础架构适配 ✅

| 任务                           | 复用率 | 状态 |
| ------------------------------ | ------ | ---- |
| 创建 `apps/windows/` 目录结构  | 参考   | ✅   |
| 实现 GatewayClient (WebSocket) | 80%    | ✅   |
| 复用设备配对流程               | 100%   | ✅   |
| 复用认证机制                   | 100%   | ✅   |
| 实现系统托盘                   | 参考   | ✅   |
| 添加 assistant.\* RPC 方法     | 扩展   | ✅   |
| 配置 Electron 打包             | 新增   | ✅   |

**已完成文件:**

- `apps/windows/src/main/index.ts`
- `apps/windows/src/main/gateway-client.ts`
- `apps/windows/src/main/tray-manager.ts`
- `apps/windows/src/main/system-service.ts`
- `apps/windows/src/main/device-pairing-service.ts`
- `apps/windows/electron-builder.json`

### 2.2 Phase 2: 核心功能开发 ✅

| 任务                      | 复用率   | 状态 |
| ------------------------- | -------- | ---- |
| 创建 Windows 助理代理配置 | 扩展     | ✅   |
| 实现文件管理工具集        | 模式复用 | ✅   |
| 实现系统监控工具集        | 模式复用 | ✅   |
| 实现进程管理工具集        | 模式复用 | ✅   |
| 实现敏感操作确认 UI       | 新增     | ✅   |
| 客户端对话界面            | 新增     | ✅   |
| 复用审计日志系统          | 100%     | ✅   |

**已完成文件:**

- `src/agents/tools/windows-assistant-tools.ts`
- `apps/windows/src/renderer/components/ChatView.tsx`
- `apps/windows/src/renderer/components/FilesView.tsx`
- `apps/windows/src/renderer/components/SystemView.tsx`
- `apps/windows/src/renderer/components/ConfirmDialog.tsx`
- `src/assistant/audit/service.ts`

### 2.3 Phase 3: 技能系统开发 ✅

| 任务                   | 复用率 | 状态 |
| ---------------------- | ------ | ---- |
| 设计技能 schema        | 扩展   | ✅   |
| 实现服务端技能加载器   | 30%    | ✅   |
| 复用/扩展技能沙箱      | 70%    | ✅   |
| 本地技能管理           | 90%    | ✅   |
| 开发内置技能：文件整理 | 新增   | ✅   |
| 开发内置技能：系统清理 | 新增   | ✅   |
| 技能商店后端 API       | 新增   | ✅   |
| 技能商店前端           | 新增   | ✅   |

**已完成文件:**

- `src/assistant/skills/types.ts`
- `src/assistant/skills/loader.ts`
- `src/assistant/skills/executor.ts`
- `src/assistant/skills/store.ts`
- `skills/builtin/file-organizer/`
- `skills/builtin/system-cleaner/`
- `apps/windows/src/renderer/components/SkillStoreView.tsx`

### 2.4 Phase 4: 商业化与优化 ✅

| 任务                  | 复用率   | 状态 |
| --------------------- | -------- | ---- |
| 用户订阅系统          | 新增     | ✅   |
| 支付对接              | 新增     | ✅   |
| 安全审计              | 复用模式 | ✅   |
| 性能优化              | -        | ✅   |
| Windows 安装包 (NSIS) | 新增     | ✅   |
| 自动更新机制          | 复用模式 | ✅   |
| 用户文档              | 新增     | ✅   |

**已完成文件:**

- `src/assistant/subscription/service.ts`
- `src/assistant/payment/service.ts`
- `apps/windows/src/main/security-utils.ts`
- `apps/windows/src/main/updater-service.ts`
- `apps/windows/docs/`

### 2.5 Admin Console 开发 ✅

| 模块         | 后端 | 前端 |
| ------------ | ---- | ---- |
| 认证系统     | ✅   | ✅   |
| 仪表盘       | ✅   | ✅   |
| 用户管理     | ✅   | ✅   |
| 订阅管理     | ✅   | ✅   |
| 操作日志     | ✅   | ✅   |
| 技能商店管理 | ✅   | ✅   |
| 系统监控     | ✅   | ✅   |
| 系统配置     | ✅   | ✅   |
| 数据分析     | ✅   | ✅   |

---

## 3. 待开发任务

### 3.1 P0 - 核心业务阻塞

| 问题                            | 影响               | 涉及模块          |
| ------------------------------- | ------------------ | ----------------- |
| Windows 客户端缺少注册/登录界面 | 用户无法使用系统   | `apps/windows`    |
| 技能商店后端全是模拟数据        | 技能功能完全不可用 | `admin-skills.ts` |
| 技能上传功能缺失                | 无法添加新技能     | 前端 + 后端       |

### 3.2 P1 - 功能不完整

| 问题                 | 影响             | 涉及模块           |
| -------------------- | ---------------- | ------------------ |
| 系统配置无法持久化   | 配置修改无效     | `admin-config.ts`  |
| 系统监控全是模拟数据 | 无法监控真实状态 | `admin-monitor.ts` |

### 3.3 P2 - 增强功能

| 问题             | 影响             | 涉及模块             |
| ---------------- | ---------------- | -------------------- |
| 数据分析无数据源 | 无法查看真实报表 | `admin-analytics.ts` |

---

## 4. 功能补全开发计划

### 4.1 Phase A: Windows 客户端用户认证 (P0)

**目标**: 为 Windows 客户端添加完整的用户认证流程

**新增组件:**

| 组件                        | 路径                                    | 功能               |
| --------------------------- | --------------------------------------- | ------------------ |
| `AuthView.tsx`              | `apps/windows/src/renderer/components/` | 认证容器组件       |
| `LoginForm.tsx`             | 同上                                    | 登录表单           |
| `RegisterForm.tsx`          | 同上                                    | 注册表单           |
| `VerificationCodeInput.tsx` | 同上                                    | 验证码输入         |
| `useAuth.ts`                | `apps/windows/src/renderer/hooks/`      | 认证状态管理       |
| `useVerificationCode.ts`    | 同上                                    | 验证码发送和倒计时 |

**开发任务:**

| 任务                              | 预计时间 |
| --------------------------------- | -------- |
| 创建 `useAuth` Hook               | 2h       |
| 创建 `useVerificationCode` Hook   | 1h       |
| 创建 `AuthView` 容器组件          | 1h       |
| 创建 `LoginForm` 组件             | 2h       |
| 创建 `RegisterForm` 组件          | 2h       |
| 创建 `VerificationCodeInput` 组件 | 1h       |
| 修改 `App.tsx` 集成认证流程       | 1h       |
| 样式调整                          | 1h       |
| 测试和调试                        | 2h       |

**总计**: 约 13 小时

### 4.2 Phase B: 技能系统数据库与后端 (P0)

**目标**: 建立完整的技能存储和管理后端

**数据库设计:**

```sql
-- skills 表
CREATE TABLE skills (
  id VARCHAR(32) PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  description TEXT,
  author_id VARCHAR(32) NOT NULL REFERENCES users(id),
  version VARCHAR(20) NOT NULL DEFAULT '1.0.0',
  category_id VARCHAR(32) REFERENCES skill_categories(id),
  tags TEXT[],
  status VARCHAR(20) NOT NULL DEFAULT 'pending',
  subscription_level VARCHAR(20) NOT NULL DEFAULT 'free',
  download_count INTEGER DEFAULT 0,
  rating_avg DECIMAL(3,2) DEFAULT 0,
  rating_count INTEGER DEFAULT 0,
  icon_url VARCHAR(500),
  manifest_url VARCHAR(500),
  package_url VARCHAR(500),
  readme TEXT,
  is_featured BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- skill_categories 表
CREATE TABLE skill_categories (
  id VARCHAR(32) PRIMARY KEY,
  name VARCHAR(50) NOT NULL,
  description TEXT,
  icon VARCHAR(50),
  sort_order INTEGER DEFAULT 0,
  skill_count INTEGER DEFAULT 0,
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- skill_reviews 表
CREATE TABLE skill_reviews (
  id VARCHAR(32) PRIMARY KEY,
  skill_id VARCHAR(32) NOT NULL REFERENCES skills(id),
  user_id VARCHAR(32) NOT NULL REFERENCES users(id),
  rating INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5),
  comment TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(skill_id, user_id)
);
```

**新增服务:**

| 文件                       | 路径                    | 功能         |
| -------------------------- | ----------------------- | ------------ |
| `skill-service.ts`         | `src/assistant/skills/` | 技能核心服务 |
| `skill-storage-service.ts` | 同上                    | 技能文件存储 |
| `skill-review-service.ts`  | 同上                    | 技能审核服务 |

**开发任务:**

| 任务                            | 预计时间 |
| ------------------------------- | -------- |
| 创建数据库 Schema (Drizzle)     | 2h       |
| 创建数据库迁移脚本              | 1h       |
| 实现 `skill-service.ts`         | 4h       |
| 实现 `skill-storage-service.ts` | 3h       |
| 实现 `skill-review-service.ts`  | 2h       |
| 重写 `admin-skills.ts` RPC 方法 | 4h       |
| 添加用户端技能上传 RPC 方法     | 3h       |
| 初始化种子数据                  | 1h       |
| 测试和调试                      | 3h       |

**总计**: 约 23 小时

### 4.3 Phase C: 技能上传功能前端 (P0)

**目标**: 为 Windows 客户端和 Admin Console 添加技能上传/管理功能

**开发任务:**

| 任务                          | 预计时间 |
| ----------------------------- | -------- |
| Windows: 对接技能商店真实数据 | 2h       |
| Windows: 创建技能上传界面     | 4h       |
| Windows: 实现技能打包逻辑     | 3h       |
| Admin Console: 对接真实后端   | 2h       |
| 测试和调试                    | 2h       |

**总计**: 约 13 小时

### 4.4 Phase D: 系统配置持久化 (P1)

**目标**: 将系统配置存储到数据库

**数据库设计:**

```sql
CREATE TABLE system_configs (
  id VARCHAR(32) PRIMARY KEY,
  category VARCHAR(50) NOT NULL,
  key VARCHAR(100) NOT NULL,
  value JSONB NOT NULL,
  updated_by VARCHAR(32) REFERENCES admins(id),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(category, key)
);
```

**开发任务:**

| 任务                          | 预计时间 |
| ----------------------------- | -------- |
| 创建 system_configs 表 Schema | 1h       |
| 实现 config-service.ts        | 3h       |
| 重写 admin-config.ts          | 3h       |
| 初始化默认配置                | 1h       |
| 测试                          | 1h       |

**总计**: 约 9 小时

### 4.5 Phase E: 系统监控真实数据 (P1)

**目标**: 采集真实系统指标

**技术方案:**

| 指标       | 来源                   | 方法                            |
| ---------- | ---------------------- | ------------------------------- |
| CPU 使用率 | Node.js `os` 模块      | `os.cpus()`                     |
| 内存使用   | Node.js `os` 模块      | `os.totalmem()`, `os.freemem()` |
| 磁盘使用   | `diskusage` 包         | `check()`                       |
| 网络流量   | `systeminformation` 包 | `networkStats()`                |

**开发任务:**

| 任务                           | 预计时间 |
| ------------------------------ | -------- |
| 实现 system-metrics-service.ts | 4h       |
| 实现 health-check-service.ts   | 2h       |
| 实现日志聚合服务               | 3h       |
| 重写 admin-monitor.ts          | 4h       |
| 测试                           | 2h       |

**总计**: 约 15 小时

### 4.6 Phase F: 数据分析真实数据 (P2)

**目标**: 基于真实业务数据生成分析报表

**开发任务:**

| 任务                    | 预计时间 |
| ----------------------- | -------- |
| 实现用户分析服务        | 4h       |
| 实现收入分析服务        | 3h       |
| 实现技能分析服务        | 2h       |
| 重写 admin-analytics.ts | 4h       |
| 测试                    | 2h       |

**总计**: 约 15 小时

---

## 5. 总体时间线

### 5.1 时间线概览

```
Week 1 (Day 1-5):
  Day 1-2: Phase A - Windows 客户端用户认证
  Day 3-5: Phase B - 技能系统数据库与后端

Week 2 (Day 6-8):
  Day 6-7: Phase C - 技能上传功能前端
  Day 8:   Phase D - 系统配置持久化

Week 3 (Day 9-10):
  Day 9:   Phase E - 系统监控真实数据
  Day 10:  Phase F - 数据分析真实数据 + 测试优化
```

### 5.2 工作量估算

| Phase   | 内容                   | 预计时间 |
| ------- | ---------------------- | -------- |
| Phase A | Windows 客户端用户认证 | 13h      |
| Phase B | 技能系统数据库与后端   | 23h      |
| Phase C | 技能上传功能前端       | 13h      |
| Phase D | 系统配置持久化         | 9h       |
| Phase E | 系统监控真实数据       | 15h      |
| Phase F | 数据分析真实数据       | 15h      |

**总计**: 约 88 小时（约 11 个工作日）

---

## 6. 里程碑

| 里程碑 | 日期   | 交付物       | 验收标准                                |
| ------ | ------ | ------------ | --------------------------------------- |
| M1     | Day 2  | 用户认证完成 | 用户可以注册、登录、使用 Windows 客户端 |
| M2     | Day 5  | 技能后端完成 | 技能数据存入数据库，API 返回真实数据    |
| M3     | Day 7  | 技能前端完成 | 用户可以上传技能，管理员可以审核        |
| M4     | Day 8  | 系统配置完成 | 配置修改后重启不丢失                    |
| M5     | Day 9  | 系统监控完成 | 显示真实 CPU/内存/磁盘使用率            |
| M6     | Day 10 | 数据分析完成 | 显示真实用户增长、收入趋势              |

---

## 7. 验收标准

### 7.1 功能验收

| 功能     | 验收标准                                |
| -------- | --------------------------------------- |
| 用户注册 | 手机/邮箱注册成功，收到验证码，创建账户 |
| 用户登录 | 密码/验证码登录成功，跳转到主界面       |
| 技能上传 | 用户可以打包并上传技能，状态为待审核    |
| 技能审核 | 管理员可以批准/拒绝技能，状态正确更新   |
| 技能下载 | 用户可以从技能商店下载已发布的技能      |
| 系统配置 | 修改配置后重启 Gateway，配置保持不变    |
| 系统监控 | 显示的 CPU/内存使用率与系统实际值一致   |
| 数据分析 | 用户增长曲线与实际注册数据一致          |

### 7.2 技术验收

| 指标         | 标准                  |
| ------------ | --------------------- |
| API 响应时间 | < 500ms (P95)         |
| 数据库查询   | 无 N+1 查询问题       |
| 代码覆盖率   | > 70%                 |
| TypeScript   | 无 any 类型滥用       |
| 安全性       | 无 SQL 注入、XSS 漏洞 |

---

## 8. 风险与缓解

| 风险                 | 影响           | 概率 | 缓解措施                      |
| -------------------- | -------------- | ---- | ----------------------------- |
| 验证码服务未配置     | 用户无法注册   | 高   | 开发环境使用固定验证码 123456 |
| 文件存储服务未就绪   | 技能无法上传   | 中   | 先使用本地文件存储            |
| 系统指标采集权限不足 | 监控数据不完整 | 低   | 降级显示可用指标              |
| Windows API 兼容性   | 中             | 中   | 充分测试 Win10/11             |
| 技能沙箱安全         | 高             | 低   | 复用现有沙箱 + 增强           |

---

## 9. 开发规范

### 9.1 代码规范

- 使用 TypeScript 严格模式
- 遵循 ESLint + Prettier 配置
- 组件使用函数式组件 + Hooks
- API 调用使用 TanStack Query
- 状态管理使用 Zustand

### 9.2 命名规范

| 类型 | 规范                 | 示例                  |
| ---- | -------------------- | --------------------- |
| 组件 | PascalCase           | `UserListPage.tsx`    |
| Hook | camelCase + use 前缀 | `useUsers.ts`         |
| 服务 | camelCase            | `userService.ts`      |
| 类型 | PascalCase           | `User`, `ApiResponse` |
| 常量 | UPPER_SNAKE_CASE     | `API_BASE_URL`        |

### 9.3 Git 规范

```
feat: 新功能
fix: Bug 修复
refactor: 重构
docs: 文档
style: 样式
test: 测试
chore: 构建/工具
```

---

## 10. 进度总结

```
已完成模块:
├── Windows 客户端基础架构 ████████████████████ 100%
├── 核心功能开发           ████████████████████ 100%
├── 技能系统开发           ████████████████████ 100%
├── 商业化与优化           ████████████████████ 100%
└── Admin Console          ████████████████████ 100%

待开发模块:
├── Windows 用户认证       ░░░░░░░░░░░░░░░░░░░░ 0%
├── 技能数据库后端         ░░░░░░░░░░░░░░░░░░░░ 0%
├── 技能上传前端           ░░░░░░░░░░░░░░░░░░░░ 0%
├── 系统配置持久化         ░░░░░░░░░░░░░░░░░░░░ 0%
├── 系统监控真实数据       ░░░░░░░░░░░░░░░░░░░░ 0%
└── 数据分析真实数据       ░░░░░░░░░░░░░░░░░░░░ 0%

总体进度: ████████████░░░░░░░░ 60%
```

---

_— 文档结束 —_

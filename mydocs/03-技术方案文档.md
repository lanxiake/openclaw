# AI ä¸ªäººåŠ©ç†å¹³å° - æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£ v2.0

> ç‰ˆæœ¬: 2.0 | åˆ›å»ºæ—¥æœŸ: 2026-02-06 | çŠ¶æ€: åŸºäºç°æœ‰æ¶æ„é‡æ„

---

## 1. æŠ€æœ¯é€‰å‹ (å¤ç”¨ç°æœ‰)

### 1.1 åç«¯æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | å¤ç”¨æ¥æº | è¯´æ˜ |
|------|------|----------|------|
| è¿è¡Œæ—¶ | Node.js 22+ | âœ… ç°æœ‰ | ä¸ OpenClaw ä¸€è‡´ |
| Web æ¡†æ¶ | Fastify 4.x | âœ… ç°æœ‰ | Gateway HTTP æœåŠ¡ |
| WebSocket | ws 8.x | âœ… ç°æœ‰ | å®æ—¶é€šä¿¡ |
| ç±»å‹éªŒè¯ | TypeBox | âœ… ç°æœ‰ | Schema å®šä¹‰å’Œè¿è¡Œæ—¶éªŒè¯ |
| é…ç½®ç®¡ç† | YAML + Zod | âœ… ç°æœ‰ | é…ç½®åŠ è½½å’ŒéªŒè¯ |
| AI æœåŠ¡ | Claude API | âœ… ç°æœ‰ | Pi Agent Core é›†æˆ |
| æ•°æ®åº“ | PostgreSQL 16 | ğŸ†• æ–°å¢ | ç”¨æˆ·ã€è®¢é˜…æ•°æ® |
| ORM | Drizzle ORM | ğŸ†• æ–°å¢ | ç±»å‹å®‰å…¨ ORM |

### 1.2 å‰ç«¯/å®¢æˆ·ç«¯æŠ€æœ¯æ ˆ

| ç±»å‹ | æŠ€æœ¯ | å¤ç”¨æ¥æº | è¯´æ˜ |
|------|------|----------|------|
| Web æ¡†æ¶ | React 18+ | ğŸ†• æ–°å¢ | ç®¡ç†åå° |
| æ„å»ºå·¥å…· | Vite 5.x | ğŸ†• æ–°å¢ | å¿«é€Ÿæ„å»º |
| UI åº“ | shadcn/ui | ğŸ†• æ–°å¢ | TailwindCSS é›†æˆ |
| æ¡Œé¢æ¡†æ¶ | Electron 28+ | ğŸ†• æ–°å¢ | Windows å®¢æˆ·ç«¯ |
| çŠ¶æ€ç®¡ç† | Zustand | ğŸ†• æ–°å¢ | è½»é‡çŠ¶æ€ç®¡ç† |

---

## 2. æ ¸å¿ƒæ¨¡å—å¤ç”¨è¯¦è§£

### 2.1 Gateway æœåŠ¡ (100% å¤ç”¨)

**æ¥æº**: `src/gateway/`

```
Gateway æ ¸å¿ƒæ¨¡å—
â”œâ”€â”€ server.impl.ts          # æœåŠ¡å™¨åˆå§‹åŒ– âœ… ç›´æ¥å¤ç”¨
â”œâ”€â”€ server-methods.ts       # RPC æ–¹æ³•æ³¨å†Œ âœ… æ‰©å±•
â”œâ”€â”€ server-ws-runtime.ts    # WebSocket è¿è¡Œæ—¶ âœ… ç›´æ¥å¤ç”¨
â”œâ”€â”€ protocol/               # åè®®å®šä¹‰ âœ… æ‰©å±•
â”‚   â””â”€â”€ schema/             # TypeBox Schema âœ… æ‰©å±•
â”œâ”€â”€ auth.ts                 # è®¤è¯ âœ… ç›´æ¥å¤ç”¨
â””â”€â”€ config-reload.ts        # é…ç½®çƒ­é‡è½½ âœ… ç›´æ¥å¤ç”¨
```

**æ‰©å±•æ–¹å¼**:
```typescript
// æ–°å¢ assistant.* RPC æ–¹æ³•ï¼Œä¸ä¿®æ”¹ç°æœ‰ä»£ç 
// ä½ç½®: src/gateway/server-methods/assistant.ts

import { Type } from '@sinclair/typebox'

export const AssistantFileListParams = Type.Object({
  path: Type.String(),
  recursive: Type.Optional(Type.Boolean()),
})

export async function assistantFileList(params: Static<typeof AssistantFileListParams>) {
  // å®ç°...
}

// æ³¨å†Œåˆ° server-methods.ts
export const assistantMethods = {
  'assistant.fileList': assistantFileList,
  'assistant.fileRead': assistantFileRead,
  'assistant.fileWrite': assistantFileWrite,
  // ...
}
```

### 2.2 AI ä»£ç†ç³»ç»Ÿ (90% å¤ç”¨)

**æ¥æº**: `src/agents/`

```
ä»£ç†ç³»ç»Ÿæ¨¡å—
â”œâ”€â”€ agent-scope.ts          # ä»£ç†ä½œç”¨åŸŸ âœ… ç›´æ¥å¤ç”¨
â”œâ”€â”€ auth-profiles.ts        # è®¤è¯é…ç½® âœ… ç›´æ¥å¤ç”¨
â”œâ”€â”€ skills/                 # æŠ€èƒ½æ¡†æ¶ âœ… æ‰©å±•
â”‚   â”œâ”€â”€ types.ts            # æŠ€èƒ½ç±»å‹ âœ… æ‰©å±•
â”‚   â”œâ”€â”€ refresh.ts          # æŠ€èƒ½çƒ­é‡è½½ âœ… å¤ç”¨
â”‚   â””â”€â”€ install.ts          # æŠ€èƒ½å®‰è£… âœ… å¤ç”¨
â””â”€â”€ tools/                  # å·¥å…·ç³»ç»Ÿ âœ… æ‰©å±•
    â””â”€â”€ common.ts           # é€šç”¨å·¥å…·å‡½æ•° âœ… ç›´æ¥å¤ç”¨
```

**å¤ç”¨å·¥å…·å‡½æ•°**:
```typescript
// æ¥è‡ª src/agents/tools/common.ts
export function readStringParam(params, key, options) { ... }
export function readNumberParam(params, key, options) { ... }
export function readBooleanParam(params, key, options) { ... }
export function sanitizeToolResultImages(images) { ... }

// åœ¨æ–°å·¥å…·ä¸­å¤ç”¨
import { readStringParam } from '@/agents/tools/common'

export const fileListTool = {
  name: 'file_list',
  async execute(params) {
    const path = readStringParam(params, 'path', { required: true })
    // ...
  }
}
```

### 2.3 æ’ä»¶ç³»ç»Ÿ (ä½œä¸ºæŠ€èƒ½ç³»ç»ŸåŸºç¡€)

**æ¥æº**: `src/plugins/`

```
æ’ä»¶ç³»ç»Ÿ
â”œâ”€â”€ discovery.ts            # æ’ä»¶å‘ç° âœ… å¤ç”¨æ¨¡å¼
â”œâ”€â”€ loader.ts               # åŠ¨æ€åŠ è½½ âœ… å¤ç”¨æ¨¡å¼
â”œâ”€â”€ runtime.ts              # è¿è¡Œæ—¶ç®¡ç† âœ… å¤ç”¨æ¨¡å¼
â””â”€â”€ types.ts                # æ’ä»¶æ¥å£ âœ… æ‰©å±•
```

**æŠ€èƒ½ç³»ç»Ÿæ‰©å±•**:
```typescript
// åŸºäº OpenClawPluginService æ‰©å±•
interface AssistantSkill extends OpenClawPluginService {
  type: 'server' | 'local'

  // å¤ç”¨ç°æœ‰å…ƒæ•°æ®
  metadata: OpenClawSkillMetadata

  // æ–°å¢ï¼šè®¢é˜…ä¿¡æ¯
  subscription?: {
    required: boolean
    price?: number
    period?: 'monthly' | 'yearly' | 'once'
  }

  // æŠ€èƒ½æ‰§è¡Œå…¥å£
  execute: (context: SkillContext) => Promise<SkillResult>
}
```

### 2.4 é…ç½®ç³»ç»Ÿ (100% å¤ç”¨)

**æ¥æº**: `src/config/`

```
é…ç½®ç³»ç»Ÿ
â”œâ”€â”€ config.ts               # é…ç½®åŠ è½½ âœ… ç›´æ¥å¤ç”¨
â”œâ”€â”€ types.*.ts              # ç±»å‹å®šä¹‰ âœ… æ‰©å±•
â”œâ”€â”€ sessions/               # ä¼šè¯ç®¡ç† âœ… ç›´æ¥å¤ç”¨
â””â”€â”€ migrations/             # é…ç½®è¿ç§» âœ… ç›´æ¥å¤ç”¨
```

**æ‰©å±•é…ç½®**:
```yaml
# ~/.openclaw/config.yaml æ–°å¢é…ç½®èŠ‚
assistant:
  enabled: true
  skills:
    serverEndpoint: "https://skills.example.com"
    localPath: "~/.openclaw/skills"

  # æ•æ„Ÿæ“ä½œç¡®è®¤çº§åˆ«
  confirmLevel: "medium"  # low | medium | high

  # Windows å®¢æˆ·ç«¯é…ç½®
  windows:
    autoStart: true
    trayIcon: true
```

### 2.5 åŸºç¡€è®¾æ–½å±‚ (100% å¤ç”¨)

**æ¥æº**: `src/infra/`

| æ¨¡å— | æ–‡ä»¶ | ç”¨é€” | å¤ç”¨æ–¹å¼ |
|------|------|------|----------|
| è®¾å¤‡é…å¯¹ | `device-pairing.ts` | äºŒç»´ç é…å¯¹ | ç›´æ¥å¤ç”¨ |
| æ‰§è¡Œå®¡æ‰¹ | `exec-approvals.ts` | æ•æ„Ÿæ“ä½œç¡®è®¤ | ç›´æ¥å¤ç”¨ |
| é‡è¯•é€»è¾‘ | `retry.ts` | ç½‘ç»œé‡è¯• | ç›´æ¥å¤ç”¨ |
| å¿ƒè·³ | `heartbeat-runner.ts` | è¿æ¥ä¿æ´» | ç›´æ¥å¤ç”¨ |
| ç«¯å£ç®¡ç† | `ports.ts` | ç«¯å£åˆ†é… | ç›´æ¥å¤ç”¨ |

---

## 3. æ–°å¢æ¨¡å—è®¾è®¡

### 3.1 Windows å®¢æˆ·ç«¯æ¶æ„

```
apps/windows/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/                       # Electron ä¸»è¿›ç¨‹
â”‚   â”‚   â”œâ”€â”€ index.ts                # å…¥å£
â”‚   â”‚   â”œâ”€â”€ gateway-client.ts       # WebSocket å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ skill-executor.ts       # æŠ€èƒ½æ²™ç®±æ‰§è¡Œ
â”‚   â”‚   â”œâ”€â”€ system-service.ts       # ç³»ç»ŸæœåŠ¡å°è£…
â”‚   â”‚   â”‚   â”œâ”€â”€ file-ops.ts         # æ–‡ä»¶æ“ä½œ
â”‚   â”‚   â”‚   â”œâ”€â”€ process-ops.ts      # è¿›ç¨‹æ“ä½œ
â”‚   â”‚   â”‚   â””â”€â”€ system-info.ts      # ç³»ç»Ÿä¿¡æ¯
â”‚   â”‚   â”œâ”€â”€ tray-manager.ts         # ç³»ç»Ÿæ‰˜ç›˜
â”‚   â”‚   â””â”€â”€ auto-updater.ts         # è‡ªåŠ¨æ›´æ–°
â”‚   â”‚
â”‚   â”œâ”€â”€ renderer/                   # æ¸²æŸ“è¿›ç¨‹ (React)
â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatPanel/          # å¯¹è¯é¢æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ ConfirmDialog/      # æ“ä½œç¡®è®¤
â”‚   â”‚   â”‚   â””â”€â”€ SkillStore/         # æŠ€èƒ½å•†åº—
â”‚   â”‚   â””â”€â”€ hooks/
â”‚   â”‚       â””â”€â”€ useGateway.ts       # Gateway è¿æ¥ Hook
â”‚   â”‚
â”‚   â””â”€â”€ preload/                    # é¢„åŠ è½½è„šæœ¬
â”‚       â””â”€â”€ index.ts                # IPC æ¡¥æ¥
â”‚
â”œâ”€â”€ electron-builder.json           # æ‰“åŒ…é…ç½®
â””â”€â”€ package.json
```

### 3.2 GatewayClient å®ç°

```typescript
// apps/windows/src/main/gateway-client.ts
import WebSocket from 'ws'
import { EventEmitter } from 'events'

// å¤ç”¨åè®®ç±»å‹
import type { Message, MessageType } from '@/gateway/protocol'

export class GatewayClient extends EventEmitter {
  private ws: WebSocket | null = null
  private reconnectTimer: NodeJS.Timer | null = null
  private pendingRequests = new Map<string, { resolve, reject, timeout }>()

  constructor(private config: GatewayClientConfig) {
    super()
  }

  async connect(): Promise<void> {
    const { url, token } = this.config

    this.ws = new WebSocket(url, {
      headers: { Authorization: `Bearer ${token}` }
    })

    this.ws.on('open', () => this.handleOpen())
    this.ws.on('message', (data) => this.handleMessage(data))
    this.ws.on('close', () => this.handleClose())
    this.ws.on('error', (err) => this.handleError(err))
  }

  // RPC è°ƒç”¨ (å¤ç”¨ç°æœ‰åè®®æ ¼å¼)
  async call<T>(method: string, params: unknown): Promise<T> {
    const id = crypto.randomUUID()
    const message: Message = {
      type: 'req',
      id,
      method,
      params,
    }

    return new Promise((resolve, reject) => {
      const timeout = setTimeout(() => {
        this.pendingRequests.delete(id)
        reject(new Error('Request timeout'))
      }, 30000)

      this.pendingRequests.set(id, { resolve, reject, timeout })
      this.send(message)
    })
  }

  // æ–‡ä»¶æ“ä½œå¿«æ·æ–¹æ³•
  async fileList(path: string): Promise<FileInfo[]> {
    return this.call('assistant.fileList', { path })
  }

  async fileRead(path: string): Promise<string> {
    return this.call('assistant.fileRead', { path })
  }

  // ... æ›´å¤šæ–¹æ³•
}
```

### 3.3 æŠ€èƒ½æ²™ç®±æ‰§è¡Œå™¨

```typescript
// apps/windows/src/main/skill-executor.ts
import { VM } from 'vm2'
import { Worker } from 'worker_threads'

export class SkillExecutor {
  private runningSkills = new Map<string, Worker>()

  constructor(private config: SkillExecutorConfig) {}

  // æ‰§è¡ŒæœåŠ¡ç«¯æŠ€èƒ½ (ä»£ç ä» Gateway åŠ¨æ€åŠ è½½)
  async executeServerSkill(
    skillCode: string,
    params: unknown,
    context: SkillContext
  ): Promise<SkillResult> {
    // åœ¨éš”ç¦»çš„ Worker ä¸­æ‰§è¡Œ
    return new Promise((resolve, reject) => {
      const worker = new Worker(
        `
        const { parentPort, workerData } = require('worker_threads')
        const vm = require('vm2')

        const sandbox = new vm.VM({
          timeout: ${this.config.timeout || 30000},
          sandbox: {
            // å®‰å…¨çš„ API ç™½åå•
            console: { log: (...args) => parentPort.postMessage({ type: 'log', args }) },
            fs: workerData.safeFs,
            system: workerData.safeSystem,
            ui: workerData.safeUi,
          }
        })

        try {
          const result = sandbox.run(workerData.code)
          parentPort.postMessage({ type: 'result', data: result })
        } catch (err) {
          parentPort.postMessage({ type: 'error', message: err.message })
        }
        `,
        {
          eval: true,
          workerData: {
            code: skillCode,
            params,
            safeFs: this.createSafeFs(context),
            safeSystem: this.createSafeSystem(context),
            safeUi: this.createSafeUi(context),
          }
        }
      )

      worker.on('message', (msg) => {
        if (msg.type === 'result') resolve(msg.data)
        if (msg.type === 'error') reject(new Error(msg.message))
      })

      // è¶…æ—¶ä¿æŠ¤
      setTimeout(() => {
        worker.terminate()
        reject(new Error('Skill execution timeout'))
      }, this.config.timeout || 30000)
    })
  }

  // åˆ›å»ºå®‰å…¨çš„æ–‡ä»¶ç³»ç»Ÿ API
  private createSafeFs(context: SkillContext) {
    return {
      readFile: async (path: string) => {
        if (!this.isPathAllowed(path, context)) {
          throw new Error('Access denied')
        }
        // å®ç°...
      },
      writeFile: async (path: string, content: string) => {
        if (!this.isPathAllowed(path, context)) {
          throw new Error('Access denied')
        }
        // éœ€è¦ç”¨æˆ·ç¡®è®¤
        const approved = await context.requestConfirm({
          action: 'file_write',
          path,
          preview: content.slice(0, 100),
        })
        if (!approved) throw new Error('User denied')
        // å®ç°...
      },
      // ...
    }
  }
}
```

### 3.4 ç³»ç»Ÿå·¥å…·é›†

```typescript
// packages/assistant-tools/file-manager/index.ts
import { Type, Static } from '@sinclair/typebox'
import { readStringParam, readBooleanParam } from '@/agents/tools/common'
import type { AnyAgentTool } from '@/agents/tools/types'
import fs from 'fs/promises'
import path from 'path'

// Schema å®šä¹‰ (å¤ç”¨ TypeBox æ¨¡å¼)
const FileListParamsSchema = Type.Object({
  path: Type.String({ description: 'ç›®å½•è·¯å¾„' }),
  recursive: Type.Optional(Type.Boolean({ default: false })),
  filter: Type.Optional(Type.String({ description: 'æ–‡ä»¶åè¿‡æ»¤ (glob)' })),
})

// å·¥å…·å®ç°
export const fileListTool: AnyAgentTool = {
  name: 'file_list',
  description: 'åˆ—å‡ºæŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹',
  parameters: FileListParamsSchema,

  async execute(params: Static<typeof FileListParamsSchema>, context) {
    const dirPath = readStringParam(params, 'path', { required: true })
    const recursive = readBooleanParam(params, 'recursive') ?? false

    // å®‰å…¨æ£€æŸ¥ï¼šç¦æ­¢è®¿é—®ç³»ç»Ÿç›®å½•
    if (isSystemPath(dirPath)) {
      throw new Error('Access to system directories is not allowed')
    }

    const entries = await fs.readdir(dirPath, { withFileTypes: true })
    const results: FileInfo[] = []

    for (const entry of entries) {
      const fullPath = path.join(dirPath, entry.name)
      const stat = await fs.stat(fullPath)

      results.push({
        name: entry.name,
        path: fullPath,
        type: entry.isDirectory() ? 'directory' : 'file',
        size: stat.size,
        modified: stat.mtime.toISOString(),
      })

      if (recursive && entry.isDirectory()) {
        // é€’å½’è·å–å­ç›®å½•
        const subResults = await this.execute({ path: fullPath, recursive: true }, context)
        results.push(...subResults)
      }
    }

    return results
  }
}

// å·¥å…·é›†å¯¼å‡º
export const fileManagerTools = [
  fileListTool,
  fileReadTool,
  fileWriteTool,
  fileMoveTool,
  fileDeleteTool,
  fileCopyTool,
  fileSearchTool,
]
```

---

## 4. é€šä¿¡åè®®æ‰©å±•

### 4.1 æ–°å¢æ¶ˆæ¯ç±»å‹

```typescript
// src/gateway/protocol/schema/assistant.ts
import { Type } from '@sinclair/typebox'

// æ–‡ä»¶æ“ä½œ
export const AssistantFileListParams = Type.Object({
  path: Type.String(),
  recursive: Type.Optional(Type.Boolean()),
})

export const AssistantFileReadParams = Type.Object({
  path: Type.String(),
  encoding: Type.Optional(Type.String({ default: 'utf-8' })),
})

export const AssistantFileWriteParams = Type.Object({
  path: Type.String(),
  content: Type.String(),
  encoding: Type.Optional(Type.String({ default: 'utf-8' })),
})

// æŠ€èƒ½æ“ä½œ
export const AssistantSkillLoadParams = Type.Object({
  skillId: Type.String(),
  version: Type.Optional(Type.String()),
})

export const AssistantSkillExecuteParams = Type.Object({
  skillId: Type.String(),
  params: Type.Unknown(),
})

// æ“ä½œç¡®è®¤
export const AssistantConfirmRequestParams = Type.Object({
  action: Type.String(),
  description: Type.String(),
  details: Type.Optional(Type.Unknown()),
  level: Type.Union([
    Type.Literal('low'),
    Type.Literal('medium'),
    Type.Literal('high'),
  ]),
})
```

### 4.2 RPC æ–¹æ³•æ³¨å†Œ

```typescript
// src/gateway/server-methods/assistant.ts
export const assistantMethods = {
  // æ–‡ä»¶æ“ä½œ
  'assistant.fileList': handleFileList,
  'assistant.fileRead': handleFileRead,
  'assistant.fileWrite': handleFileWrite,
  'assistant.fileMove': handleFileMove,
  'assistant.fileDelete': handleFileDelete,
  'assistant.fileCopy': handleFileCopy,
  'assistant.fileSearch': handleFileSearch,

  // ç³»ç»Ÿæ“ä½œ
  'assistant.systemInfo': handleSystemInfo,
  'assistant.processList': handleProcessList,
  'assistant.processKill': handleProcessKill,

  // æŠ€èƒ½æ“ä½œ
  'assistant.skillList': handleSkillList,
  'assistant.skillLoad': handleSkillLoad,
  'assistant.skillExecute': handleSkillExecute,
  'assistant.skillUnload': handleSkillUnload,

  // æ“ä½œç¡®è®¤
  'assistant.confirmRequest': handleConfirmRequest,
  'assistant.confirmResponse': handleConfirmResponse,
}
```

---

## 5. å®‰å…¨æ–¹æ¡ˆ (å¤ç”¨ + å¢å¼º)

### 5.1 å¤ç”¨ç°æœ‰å®‰å…¨æœºåˆ¶

| æœºåˆ¶ | æ¥æº | è¯´æ˜ |
|------|------|------|
| TLS åŠ å¯† | Gateway é…ç½® | æ‰€æœ‰é€šä¿¡åŠ å¯† |
| JWT è®¤è¯ | `src/gateway/auth.ts` | Token è®¤è¯ |
| è®¾å¤‡é…å¯¹ | `src/infra/device-pairing.ts` | å®‰å…¨é…å¯¹ |
| æ‰§è¡Œå®¡æ‰¹ | `src/infra/exec-approvals.ts` | æ•æ„Ÿæ“ä½œç¡®è®¤ |

### 5.2 æ–°å¢å®‰å…¨æœºåˆ¶

**æŠ€èƒ½æ²™ç®±å®‰å…¨**:
```typescript
// èµ„æºé™åˆ¶
const sandboxConfig = {
  timeout: 30000,           // 30 ç§’è¶…æ—¶
  memoryLimit: 256 * 1024 * 1024,  // 256MB å†…å­˜

  // API ç™½åå•
  allowedApis: [
    'fs.readFile',
    'fs.writeFile',
    'fs.readdir',
    'system.getCpuUsage',
    'system.getMemoryUsage',
    'ui.confirm',
    'ui.notify',
  ],

  // æ–‡ä»¶ç³»ç»Ÿé™åˆ¶
  allowedPaths: [
    '~/Documents',
    '~/Downloads',
    '~/Desktop',
  ],

  // ç¦æ­¢è®¿é—®
  deniedPaths: [
    'C:\\Windows',
    'C:\\Program Files',
    '~/.ssh',
    '~/.gnupg',
  ],
}
```

**æ•æ„Ÿæ“ä½œåˆ†çº§** (å¤ç”¨ `exec-approvals.ts` æ¨¡å¼):
```typescript
const operationLevels = {
  // ä½é£é™©ï¼šç›´æ¥æ‰§è¡Œ
  low: ['file_list', 'file_read', 'system_info', 'process_list'],

  // ä¸­é£é™©ï¼šå•æ¬¡ç¡®è®¤
  medium: ['file_write', 'file_move', 'file_copy', 'app_launch'],

  // é«˜é£é™©ï¼šäºŒæ¬¡ç¡®è®¤
  high: ['file_delete', 'process_kill', 'system_config'],

  // ç¦æ­¢ï¼šæ‹’ç»æ‰§è¡Œ
  blocked: ['format_disk', 'registry_edit', 'system_restore'],
}
```

---

## 6. éƒ¨ç½²æ–¹æ¡ˆ

### 6.1 Gateway éƒ¨ç½² (å¤ç”¨ç°æœ‰)

ç°æœ‰ OpenClaw Gateway éƒ¨ç½²æ–¹å¼å®Œå…¨é€‚ç”¨ï¼š

```bash
# æœ¬åœ°è¿è¡Œ
openclaw gateway run --bind loopback --port 18789

# Docker éƒ¨ç½²
docker run -d \
  -p 18789:18789 \
  -v ~/.openclaw:/root/.openclaw \
  openclaw/gateway
```

### 6.2 Windows å®¢æˆ·ç«¯åˆ†å‘

| åˆ†å‘æ–¹å¼ | è¯´æ˜ |
|----------|------|
| å®˜ç½‘ä¸‹è½½ | NSIS å®‰è£…åŒ… (.exe) |
| ä¾¿æºç‰ˆ | å…å®‰è£…å‹ç¼©åŒ… (.zip) |
| è‡ªåŠ¨æ›´æ–° | electron-updater |

```json
// electron-builder.json
{
  "appId": "com.openclaw.assistant",
  "productName": "OpenClaw Assistant",
  "win": {
    "target": ["nsis", "zip"],
    "icon": "assets/icon.ico"
  },
  "nsis": {
    "oneClick": false,
    "allowToChangeInstallationDirectory": true,
    "createDesktopShortcut": true,
    "createStartMenuShortcut": true
  },
  "publish": {
    "provider": "generic",
    "url": "https://releases.openclaw.ai/assistant"
  }
}
```

---

## 7. é¡¹ç›®ç»“æ„æ€»ç»“

```
openclaw/
â”œâ”€â”€ src/                              # æ ¸å¿ƒä»£ç  (ä¸ä¿®æ”¹)
â”‚   â”œâ”€â”€ gateway/                      # âœ… å¤ç”¨
â”‚   â”œâ”€â”€ agents/                       # âœ… å¤ç”¨
â”‚   â”œâ”€â”€ plugins/                      # âœ… å¤ç”¨
â”‚   â”œâ”€â”€ config/                       # âœ… å¤ç”¨
â”‚   â”œâ”€â”€ routing/                      # âœ… å¤ç”¨
â”‚   â”œâ”€â”€ infra/                        # âœ… å¤ç”¨
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ packages/                         # ğŸ†• æ–°å¢åŒ…
â”‚   â”œâ”€â”€ assistant-skills/             # æŠ€èƒ½ç³»ç»Ÿ
â”‚   â”œâ”€â”€ assistant-tools/              # Windows å·¥å…·
â”‚   â””â”€â”€ assistant-shared/             # å…±äº«ä»£ç 
â”‚
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ macos/                        # âœ… ç°æœ‰
â”‚   â”œâ”€â”€ ios/                          # âœ… ç°æœ‰
â”‚   â”œâ”€â”€ android/                      # âœ… ç°æœ‰
â”‚   â””â”€â”€ windows/                      # ğŸ†• æ–°å¢
â”‚
â””â”€â”€ skills/                           # ğŸ†• æŠ€èƒ½åº“
    â”œâ”€â”€ server/
    â””â”€â”€ templates/
```

---

*â€” æ–‡æ¡£ç»“æŸ â€”*

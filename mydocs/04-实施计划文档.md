# AI ä¸ªäººåŠ©ç†å¹³å° - å®æ–½è®¡åˆ’æ–‡æ¡£ v2.2

> ç‰ˆæœ¬: 3.1 | åˆ›å»ºæ—¥æœŸ: 2026-02-06 | æ›´æ–°æ—¥æœŸ: 2026-02-07 | çŠ¶æ€: Phase 1-4 å…¨éƒ¨å®Œæˆ

---

## 1. æ¶æ„å¤ç”¨åˆ†æ

### 1.1 ç°æœ‰ OpenClaw æ ¸å¿ƒèƒ½åŠ›

ç»è¿‡æ·±å…¥åˆ†æï¼ŒOpenClaw é¡¹ç›®å·²å…·å¤‡ä»¥ä¸‹ç”Ÿäº§çº§èƒ½åŠ›ï¼š

| èƒ½åŠ› | ç°æœ‰å®ç° | å¤ç”¨ä»·å€¼ |
|------|----------|----------|
| Gateway æœåŠ¡ | `src/gateway/` - WebSocket RPC æœåŠ¡å™¨ | â­â­â­â­â­ ç›´æ¥å¤ç”¨ |
| é€šä¿¡åè®® | TypeBox schema + JSON-RPC | â­â­â­â­â­ ç›´æ¥å¤ç”¨ |
| æ’ä»¶ç³»ç»Ÿ | `src/plugins/` - çƒ­åŠ è½½æ’ä»¶æ¡†æ¶ | â­â­â­â­â­ æŠ€èƒ½ç³»ç»ŸåŸºç¡€ |
| å¤šé€šé“æ”¯æŒ | 30+ æ¶ˆæ¯é€šé“é€‚é…å™¨ | â­â­â­â­ é€‰æ‹©æ€§å¤ç”¨ |
| AI ä»£ç† | Pi Agent Core é›†æˆ | â­â­â­â­â­ ç›´æ¥å¤ç”¨ |
| é…ç½®ç³»ç»Ÿ | YAML + Zod éªŒè¯ | â­â­â­â­â­ ç›´æ¥å¤ç”¨ |
| è®¤è¯æœºåˆ¶ | è®¾å¤‡é…å¯¹ + JWT Token | â­â­â­â­â­ ç›´æ¥å¤ç”¨ |
| æ¶ˆæ¯è·¯ç”± | `src/routing/` - Session Key è·¯ç”± | â­â­â­â­ æ‰©å±•å¤ç”¨ |
| å·¥å…·ç³»ç»Ÿ | `src/agents/tools/` | â­â­â­â­â­ æ‰©å±•å¤ç”¨ |
| æ—¥å¿—ç³»ç»Ÿ | å­ç³»ç»Ÿæ—¥å¿— + ç»“æ„åŒ–æ—¥å¿— | â­â­â­â­â­ ç›´æ¥å¤ç”¨ |

### 1.2 éœ€æ±‚ä¸ç°æœ‰èƒ½åŠ›æ˜ å°„

| æ–°éœ€æ±‚ | ç°æœ‰èƒ½åŠ› | å®ç°ç­–ç•¥ |
|--------|----------|----------|
| è‡ªç„¶è¯­è¨€æ§åˆ¶ | Pi Agent Core + Claude API | ç›´æ¥å¤ç”¨ï¼Œå®šåˆ¶ Prompt |
| æŠ€èƒ½ç³»ç»Ÿ | `src/plugins/` + `src/agents/skills/` | æ‰©å±•ä¸ºæœåŠ¡ç«¯/æœ¬åœ°åŒæ¨¡å¼ |
| æ–‡ä»¶ç®¡ç† | æ— ä¸“é—¨å®ç° | æ–°å»ºå·¥å…·ï¼Œå¤ç”¨å·¥å…·æ³¨å†Œæ¨¡å¼ |
| ç³»ç»Ÿç›‘æ§ | éƒ¨åˆ†å·¥å…·å­˜åœ¨ | æ–°å»ºå·¥å…·é›† |
| è®¾å¤‡é…å¯¹ | `src/infra/device-pairing.ts` | ç›´æ¥å¤ç”¨ |
| æ•æ„Ÿæ“ä½œç¡®è®¤ | `src/infra/exec-approvals.ts` | ç›´æ¥å¤ç”¨ |
| WebSocket é€šä¿¡ | `src/gateway/server-ws-runtime.ts` | ç›´æ¥å¤ç”¨ |
| ç”¨æˆ·è®¤è¯ | `src/gateway/auth.ts` | æ‰©å±•æ”¯æŒå¤šè®¤è¯æ–¹å¼ |

### 1.3 æ–°å¢å¼€å‘å†…å®¹

| æ¨¡å— | è¯´æ˜ | ä¼˜å…ˆçº§ |
|------|------|--------|
| Windows å®¢æˆ·ç«¯ | Electron æ¡Œé¢åº”ç”¨ | P0 |
| æŠ€èƒ½å•†åº—æœåŠ¡ | æŠ€èƒ½åˆ†å‘ã€è®¢é˜…ç®¡ç† | P1 |
| è®¡è´¹ç³»ç»Ÿ | è®¢é˜…ã€æŒ‰æ¬¡è®¡è´¹ | P2 |
| Web ç®¡ç†åå° | è®¾å¤‡ç®¡ç†ã€æŠ€èƒ½ç®¡ç† | P1 |

---

## 2. é‡æ„åçš„ç³»ç»Ÿæ¶æ„

### 2.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·å±‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Win å®¢æˆ·ç«¯â”‚  â”‚ Web åå° â”‚  â”‚ ç§»åŠ¨ App â”‚  â”‚ å¾®ä¿¡/å…¶ä»– â”‚        â”‚
â”‚  â”‚(Electron)â”‚  â”‚ (React)  â”‚  â”‚(å¤ç”¨iOS) â”‚  â”‚ (å¤ç”¨)   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚             â”‚             â”‚             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ WebSocket (å¤ç”¨ç°æœ‰åè®®)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Gateway å±‚ (å¤ç”¨ src/gateway/)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    OpenClaw Gateway                        â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚â”‚
â”‚  â”‚  â”‚è¿æ¥ç®¡ç†   â”‚ â”‚æ¶ˆæ¯è·¯ç”±   â”‚ â”‚ AI ä»£ç†  â”‚ â”‚æŠ€èƒ½åŠ è½½å™¨â”‚      â”‚â”‚
â”‚  â”‚  â”‚(å¤ç”¨)    â”‚ â”‚(å¤ç”¨)    â”‚ â”‚(å¤ç”¨)    â”‚ â”‚(æ–°å¢)    â”‚      â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚â”‚
â”‚  â”‚  â”‚è®¤è¯æœåŠ¡   â”‚ â”‚é…ç½®ç®¡ç†   â”‚ â”‚å®¡è®¡æ—¥å¿—   â”‚ â”‚æŠ€èƒ½å•†åº—   â”‚      â”‚â”‚
â”‚  â”‚  â”‚(å¤ç”¨)    â”‚ â”‚(å¤ç”¨)    â”‚ â”‚(å¤ç”¨)    â”‚ â”‚(æ–°å¢)    â”‚      â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å®¢æˆ·ç«¯å±‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚              Windows å®¢æˆ·ç«¯ (æ–°å¢ Electron)                 â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚â”‚
â”‚  â”‚  â”‚Gateway   â”‚ â”‚æŠ€èƒ½æ‰§è¡Œå™¨ â”‚ â”‚ç³»ç»ŸæœåŠ¡   â”‚ â”‚ æ‰˜ç›˜ç®¡ç† â”‚      â”‚â”‚
â”‚  â”‚  â”‚Client    â”‚ â”‚(æ²™ç®±)    â”‚ â”‚(æ–‡ä»¶/è¿›ç¨‹)â”‚ â”‚         â”‚      â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ä»£ç ç»„ç»‡ç»“æ„

```
openclaw/
â”œâ”€â”€ src/                              # ç°æœ‰æ ¸å¿ƒ (ä¿æŒä¸å˜)
â”‚   â”œâ”€â”€ gateway/                      # Gateway æœåŠ¡ âœ… å¤ç”¨
â”‚   â”œâ”€â”€ agents/                       # AI ä»£ç† âœ… å¤ç”¨
â”‚   â”œâ”€â”€ plugins/                      # æ’ä»¶ç³»ç»Ÿ âœ… å¤ç”¨
â”‚   â”œâ”€â”€ config/                       # é…ç½®ç®¡ç† âœ… å¤ç”¨
â”‚   â”œâ”€â”€ routing/                      # æ¶ˆæ¯è·¯ç”± âœ… å¤ç”¨
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ packages/                         # æ–°å¢ï¼šAI åŠ©ç†ä¸“ç”¨åŒ…
â”‚   â”œâ”€â”€ assistant-skills/             # æŠ€èƒ½ç³»ç»Ÿæ‰©å±•
â”‚   â”‚   â”œâ”€â”€ loader/                   # æœåŠ¡ç«¯æŠ€èƒ½åŠ è½½å™¨
â”‚   â”‚   â”œâ”€â”€ sandbox/                  # æŠ€èƒ½æ²™ç®±æ‰§è¡Œ
â”‚   â”‚   â”œâ”€â”€ store/                    # æŠ€èƒ½å•†åº—æœåŠ¡
â”‚   â”‚   â””â”€â”€ builtin/                  # å†…ç½®æŠ€èƒ½
â”‚   â”‚       â”œâ”€â”€ file-organizer/
â”‚   â”‚       â”œâ”€â”€ system-cleaner/
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ assistant-tools/              # Windows ä¸“ç”¨å·¥å…·
â”‚   â”‚   â”œâ”€â”€ file-manager/             # æ–‡ä»¶ç®¡ç†å·¥å…·
â”‚   â”‚   â”œâ”€â”€ system-monitor/           # ç³»ç»Ÿç›‘æ§å·¥å…·
â”‚   â”‚   â”œâ”€â”€ process-manager/          # è¿›ç¨‹ç®¡ç†å·¥å…·
â”‚   â”‚   â””â”€â”€ automation/               # è‡ªåŠ¨åŒ–å·¥å…·
â”‚   â”‚
â”‚   â””â”€â”€ assistant-shared/             # å…±äº«ç±»å‹å’Œå·¥å…·
â”‚       â”œâ”€â”€ types/
â”‚       â””â”€â”€ utils/
â”‚
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ macos/                        # ç°æœ‰ macOS åº”ç”¨ âœ…
â”‚   â”œâ”€â”€ ios/                          # ç°æœ‰ iOS åº”ç”¨ âœ…
â”‚   â”œâ”€â”€ android/                      # ç°æœ‰ Android åº”ç”¨ âœ…
â”‚   â”‚
â”‚   â””â”€â”€ windows/                      # æ–°å¢ï¼šWindows å®¢æˆ·ç«¯
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ main/                 # Electron ä¸»è¿›ç¨‹
â”‚       â”‚   â”‚   â”œâ”€â”€ gateway-client.ts # WebSocket å®¢æˆ·ç«¯
â”‚       â”‚   â”‚   â”œâ”€â”€ skill-executor.ts # æŠ€èƒ½æ‰§è¡Œå™¨
â”‚       â”‚   â”‚   â”œâ”€â”€ system-service.ts # ç³»ç»ŸæœåŠ¡
â”‚       â”‚   â”‚   â””â”€â”€ tray-manager.ts   # æ‰˜ç›˜ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ renderer/             # æ¸²æŸ“è¿›ç¨‹ (React)
â”‚       â”‚   â””â”€â”€ preload/              # é¢„åŠ è½½è„šæœ¬
â”‚       â”œâ”€â”€ electron-builder.json
â”‚       â””â”€â”€ package.json
â”‚
â””â”€â”€ skills/                           # å®˜æ–¹æŠ€èƒ½åº“ (æ–°å¢ç›®å½•ç»“æ„)
    â”œâ”€â”€ server/                       # æœåŠ¡ç«¯æŠ€èƒ½
    â”‚   â”œâ”€â”€ file-organizer/
    â”‚   â”œâ”€â”€ system-cleaner/
    â”‚   â””â”€â”€ ...
    â””â”€â”€ templates/                    # æŠ€èƒ½æ¨¡æ¿
        â””â”€â”€ skill-template/
```

---

## 3. åˆ†é˜¶æ®µå®æ–½è®¡åˆ’

### Phase 1: åŸºç¡€æ¶æ„é€‚é… (å¤ç”¨ä¸ºä¸»)

**ç›®æ ‡**: åœ¨ç°æœ‰æ¶æ„ä¸Šæ­å»º AI åŠ©ç†çš„åŸºç¡€èƒ½åŠ›

#### 1.1 Gateway æ‰©å±•

| ä»»åŠ¡ | å¤ç”¨/æ–°å¢ | æ–‡ä»¶ä½ç½® | è¯´æ˜ |
|------|----------|----------|------|
| æ·»åŠ  Windows å®¢æˆ·ç«¯ RPC æ–¹æ³• | æ‰©å±• | `src/gateway/server-methods/` | æ–°å¢ `assistant.*` æ–¹æ³• |
| æŠ€èƒ½åŠ è½½åè®® | æ–°å¢ | `src/gateway/protocol/schema/skills.ts` | TypeBox schema |
| æ•æ„Ÿæ“ä½œç¡®è®¤æµç¨‹ | å¤ç”¨ | `src/infra/exec-approvals.ts` | é€‚é… Windows åœºæ™¯ |

**å¤ç”¨ä»£ç ç¤ºä¾‹**:
```typescript
// å¤ç”¨ç°æœ‰çš„ RPC æ–¹æ³•æ³¨å†Œæ¨¡å¼ (src/gateway/server-methods.ts)
export const assistantMethods = {
  'assistant.fileList': fileListHandler,
  'assistant.fileMove': fileMoveHandler,
  'assistant.skillExecute': skillExecuteHandler,
  // ...
}
```

#### 1.2 Windows å®¢æˆ·ç«¯æ¡†æ¶

| ä»»åŠ¡ | è¯´æ˜ | ä¾èµ– |
|------|------|------|
| Electron é¡¹ç›®åˆå§‹åŒ– | åŸºäº `apps/macos` ç»“æ„å‚è€ƒ | - |
| WebSocket å®¢æˆ·ç«¯ | å¤ç”¨åè®®ï¼Œæ–°å»ºå®¢æˆ·ç«¯ | `src/gateway/protocol/` |
| ç³»ç»Ÿæ‰˜ç›˜ | ç±»ä¼¼ macOS èœå•æ åº”ç”¨ | - |
| è‡ªåŠ¨æ›´æ–° | electron-updater | - |

#### 1.3 ä»»åŠ¡æ¸…å•

| # | ä»»åŠ¡ | å¤ç”¨ç‡ | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|---|------|--------|--------|------|
| 1.1 | åˆ›å»º `apps/windows/` ç›®å½•ç»“æ„ | å‚è€ƒ | P0 | âœ… å®Œæˆ |
| 1.2 | å®ç° GatewayClient (WebSocket) | 80% | P0 | âœ… å®Œæˆ |
| 1.3 | å¤ç”¨è®¾å¤‡é…å¯¹æµç¨‹ | 100% | P0 | âœ… å®Œæˆ |
| 1.4 | å¤ç”¨è®¤è¯æœºåˆ¶ | 100% | P0 | âœ… å®Œæˆ |
| 1.5 | å®ç°ç³»ç»Ÿæ‰˜ç›˜ | å‚è€ƒ | P0 | âœ… å®Œæˆ |
| 1.6 | æ·»åŠ  assistant.* RPC æ–¹æ³• | æ‰©å±• | P0 | âœ… å®Œæˆ |
| 1.7 | é…ç½® Electron æ‰“åŒ… | æ–°å¢ | P1 | âœ… å®Œæˆ |

**å·²å®Œæˆæ–‡ä»¶:**
- `apps/windows/src/main/index.ts` - Electron ä¸»è¿›ç¨‹å…¥å£
- `apps/windows/src/main/gateway-client.ts` - WebSocket å®¢æˆ·ç«¯
- `apps/windows/src/main/tray-manager.ts` - ç³»ç»Ÿæ‰˜ç›˜ç®¡ç†
- `apps/windows/src/main/system-service.ts` - ç³»ç»ŸæœåŠ¡
- `apps/windows/src/main/device-pairing-service.ts` - è®¾å¤‡é…å¯¹æœåŠ¡
- `apps/windows/src/preload/index.ts` - é¢„åŠ è½½è„šæœ¬ (å«è®¾å¤‡é…å¯¹ API)
- `apps/windows/src/renderer/hooks/useDevicePairing.ts` - è®¾å¤‡é…å¯¹ Hook
- `apps/windows/electron-builder.json` - æ‰“åŒ…é…ç½®
- `src/gateway/server-methods/assistant.ts` - åŠ©æ‰‹ RPC æ–¹æ³•

---

### Phase 2: æ ¸å¿ƒåŠŸèƒ½å¼€å‘

**ç›®æ ‡**: å®ç° AI å¯¹è¯å’ŒåŸºç¡€ç³»ç»Ÿæ§åˆ¶

#### 2.1 AI ä»£ç†é€‚é…

| ä»»åŠ¡ | å¤ç”¨/æ–°å¢ | è¯´æ˜ |
|------|----------|------|
| å¤ç”¨ Pi Agent Core | 100% å¤ç”¨ | `src/agents/` |
| å®šåˆ¶ Windows åŠ©ç† Prompt | æ–°å¢ | ç³»ç»Ÿæ§åˆ¶åœºæ™¯ |
| å·¥å…·æ³¨å†Œ | å¤ç”¨æ¨¡å¼ | æ³¨å†Œ Windows å·¥å…· |

**å¤ç”¨ä»£ç ç¤ºä¾‹**:
```typescript
// å¤ç”¨å·¥å…·æ³¨å†Œæ¨¡å¼ (src/agents/tools/common.ts)
import { readStringParam, readNumberParam } from '@/agents/tools/common'

export const fileListTool: AnyAgentTool = {
  name: 'file_list',
  description: 'åˆ—å‡ºæŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶',
  parameters: FileListParamsSchema,
  async execute(params) {
    const path = readStringParam(params, 'path', { required: true })
    // å®ç°...
  }
}
```

#### 2.2 ç³»ç»Ÿå·¥å…·é›†

| å·¥å…· | ä½ç½® | åŠŸèƒ½ |
|------|------|------|
| file_list | `packages/assistant-tools/file-manager/` | åˆ—å‡ºæ–‡ä»¶ |
| file_read | åŒä¸Š | è¯»å–æ–‡ä»¶ |
| file_write | åŒä¸Š | å†™å…¥æ–‡ä»¶ |
| file_move | åŒä¸Š | ç§»åŠ¨/é‡å‘½å |
| file_delete | åŒä¸Š | åˆ é™¤æ–‡ä»¶ |
| system_info | `packages/assistant-tools/system-monitor/` | ç³»ç»Ÿä¿¡æ¯ |
| process_list | `packages/assistant-tools/process-manager/` | è¿›ç¨‹åˆ—è¡¨ |
| process_kill | åŒä¸Š | ç»“æŸè¿›ç¨‹ |
| app_launch | `packages/assistant-tools/automation/` | å¯åŠ¨ç¨‹åº |

#### 2.3 ä»»åŠ¡æ¸…å•

| # | ä»»åŠ¡ | å¤ç”¨ç‡ | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|---|------|--------|--------|------|
| 2.1 | åˆ›å»º Windows åŠ©ç†ä»£ç†é…ç½® | æ‰©å±• | P0 | âœ… å®Œæˆ |
| 2.2 | å®ç°æ–‡ä»¶ç®¡ç†å·¥å…·é›† | æ¨¡å¼å¤ç”¨ | P0 | âœ… å®Œæˆ |
| 2.3 | å®ç°ç³»ç»Ÿç›‘æ§å·¥å…·é›† | æ¨¡å¼å¤ç”¨ | P1 | âœ… å®Œæˆ |
| 2.4 | å®ç°è¿›ç¨‹ç®¡ç†å·¥å…·é›† | æ¨¡å¼å¤ç”¨ | P1 | âœ… å®Œæˆ |
| 2.5 | å®ç°æ•æ„Ÿæ“ä½œç¡®è®¤ UI | æ–°å¢ | P0 | âœ… å®Œæˆ |
| 2.6 | å®¢æˆ·ç«¯å¯¹è¯ç•Œé¢ | æ–°å¢ | P0 | âœ… å®Œæˆ |
| 2.7 | å¤ç”¨å®¡è®¡æ—¥å¿—ç³»ç»Ÿ | 100% | P1 | âœ… å®Œæˆ |

**å·²å®Œæˆæ–‡ä»¶:**
- `src/agents/tools/windows-assistant-tools.ts` - Windows åŠ©ç†å·¥å…·é›†
- `apps/windows/src/renderer/hooks/useFileManager.ts` - æ–‡ä»¶ç®¡ç† Hook
- `apps/windows/src/renderer/components/FilesView.tsx` - æ–‡ä»¶ç®¡ç†è§†å›¾
- `apps/windows/src/renderer/hooks/useSystemMonitor.ts` - ç³»ç»Ÿç›‘æ§ Hook
- `apps/windows/src/renderer/components/SystemView.tsx` - ç³»ç»Ÿç›‘æ§è§†å›¾
- `apps/windows/src/renderer/components/ConfirmDialog.tsx` - æ•æ„Ÿæ“ä½œç¡®è®¤
- `apps/windows/src/renderer/hooks/useConfirmRequests.ts` - ç¡®è®¤è¯·æ±‚ Hook
- `apps/windows/src/renderer/components/ChatView.tsx` - å¯¹è¯ç•Œé¢
- `apps/windows/src/renderer/hooks/useChatHistory.ts` - èŠå¤©å†å²æŒä¹…åŒ–
- `src/assistant/audit/types.ts` - å®¡è®¡æ—¥å¿—ç±»å‹å®šä¹‰
- `src/assistant/audit/service.ts` - å®¡è®¡æ—¥å¿—æœåŠ¡
- `src/assistant/audit/index.ts` - å®¡è®¡æ—¥å¿—æ¨¡å—å…¥å£
- `src/gateway/server-methods/assistant-audit.ts` - å®¡è®¡æ—¥å¿— RPC æ–¹æ³•
- `apps/windows/src/renderer/hooks/useAuditLog.ts` - å®¡è®¡æ—¥å¿— Hook
- `apps/windows/src/renderer/components/AuditLogView.tsx` - å®¡è®¡æ—¥å¿—è§†å›¾
- `apps/windows/src/renderer/components/AuditLogView.css` - å®¡è®¡æ—¥å¿—æ ·å¼

**é¢å¤–å®Œæˆ:**
- `apps/windows/src/renderer/components/SettingsView.tsx` - è®¾ç½®é¡µé¢
- `apps/windows/src/renderer/hooks/useSettings.ts` - è®¾ç½®ç®¡ç† Hook
- `apps/windows/src/renderer/components/Sidebar.tsx` - ä¾§è¾¹æ å¯¼èˆª

---

### Phase 3: æŠ€èƒ½ç³»ç»Ÿå¼€å‘

**ç›®æ ‡**: å®ç°æœåŠ¡ç«¯æŠ€èƒ½ + æœ¬åœ°æŠ€èƒ½åŒæ¨¡å¼

#### 3.1 æŠ€èƒ½æ¶æ„

```
æŠ€èƒ½ç³»ç»Ÿæ¶æ„ (åŸºäº src/plugins/ æ‰©å±•)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æŠ€èƒ½ç®¡ç†å™¨                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æœåŠ¡ç«¯æŠ€èƒ½åŠ è½½å™¨ â”‚ â”‚  æœ¬åœ°æŠ€èƒ½åŠ è½½å™¨  â”‚   â”‚
â”‚  â”‚  (æ–°å¢)         â”‚ â”‚  (å¤ç”¨ plugins) â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                    â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            æŠ€èƒ½æ²™ç®±æ‰§è¡Œå™¨              â”‚  â”‚
â”‚  â”‚   (åŸºäº src/agents/skills/ æ‰©å±•)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2 å¤ç”¨ç°æœ‰æŠ€èƒ½ç³»ç»Ÿ

```typescript
// å¤ç”¨ src/agents/skills/types.ts çš„æ¨¡å¼
interface AssistantSkill {
  id: string
  name: string
  version: string
  type: 'server' | 'local'

  // å¤ç”¨ç°æœ‰å…ƒæ•°æ®ç»“æ„
  metadata: {
    requires?: {
      bins?: string[]
      env?: string[]
    }
    install?: SkillInstallSpec[]
  }

  // æ–°å¢ï¼šè®¢é˜…ä¿¡æ¯
  subscription?: {
    required: boolean
    price?: number
    period?: 'monthly' | 'yearly' | 'once'
  }
}
```

#### 3.3 ä»»åŠ¡æ¸…å•

| # | ä»»åŠ¡ | å¤ç”¨ç‡ | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|---|------|--------|--------|------|
| 3.1 | è®¾è®¡æŠ€èƒ½ schema (æ‰©å±• TypeBox) | æ‰©å±• | P0 | âœ… å®Œæˆ |
| 3.2 | å®ç°æœåŠ¡ç«¯æŠ€èƒ½åŠ è½½å™¨ | 30% | P0 | âœ… å®Œæˆ |
| 3.3 | å¤ç”¨/æ‰©å±•æŠ€èƒ½æ²™ç®± | 70% | P0 | âœ… å®Œæˆ |
| 3.4 | æœ¬åœ°æŠ€èƒ½ç®¡ç† (å¤ç”¨ plugins) | 90% | P1 | âœ… å®Œæˆ |
| 3.5 | å¼€å‘å†…ç½®æŠ€èƒ½ï¼šæ–‡ä»¶æ•´ç† | æ–°å¢ | P1 | âœ… å®Œæˆ |
| 3.6 | å¼€å‘å†…ç½®æŠ€èƒ½ï¼šç³»ç»Ÿæ¸…ç† | æ–°å¢ | P2 | âœ… å®Œæˆ |
| 3.7 | æŠ€èƒ½å•†åº—åç«¯ API | æ–°å¢ | P1 | âœ… å®Œæˆ |
| 3.8 | æŠ€èƒ½å•†åº—å‰ç«¯ | æ–°å¢ | P2 | âœ… å®Œæˆ |

**å·²å®Œæˆæ–‡ä»¶:**
- `src/assistant/skills/types.ts` - æŠ€èƒ½ç±»å‹å®šä¹‰
- `src/assistant/skills/loader.ts` - æŠ€èƒ½åŠ è½½å™¨
- `src/assistant/skills/executor.ts` - æŠ€èƒ½æ‰§è¡Œå™¨
- `src/assistant/skills/index.ts` - æŠ€èƒ½æ¨¡å—å…¥å£
- `src/assistant/skills/store.ts` - æŠ€èƒ½å•†åº—æœåŠ¡
- `src/gateway/server-methods/assistant-skills.ts` - æŠ€èƒ½ RPC æ–¹æ³• (å«å•†åº— API)
- `skills/builtin/file-organizer/skill.json` - æ–‡ä»¶æ•´ç†æŠ€èƒ½æ¸…å•
- `skills/builtin/file-organizer/index.js` - æ–‡ä»¶æ•´ç†æŠ€èƒ½å®ç°
- `skills/builtin/system-cleaner/skill.json` - ç³»ç»Ÿæ¸…ç†æŠ€èƒ½æ¸…å•
- `skills/builtin/system-cleaner/index.js` - ç³»ç»Ÿæ¸…ç†æŠ€èƒ½å®ç°
- `apps/windows/src/renderer/components/SkillsView.tsx` - æŠ€èƒ½ç®¡ç† UI
- `apps/windows/src/renderer/hooks/useSkills.ts` - æŠ€èƒ½ç®¡ç† Hook
- `apps/windows/src/renderer/components/SkillStoreView.tsx` - æŠ€èƒ½å•†åº— UI
- `apps/windows/src/renderer/components/SkillStoreView.css` - æŠ€èƒ½å•†åº—æ ·å¼
- `apps/windows/src/renderer/hooks/useSkillStore.ts` - æŠ€èƒ½å•†åº— Hook

---

### Phase 4: å•†ä¸šåŒ–ä¸ä¼˜åŒ–

**ç›®æ ‡**: å®Œæˆè®¡è´¹ç³»ç»Ÿã€å®‰å…¨åŠ å›ºã€æ­£å¼å‘å¸ƒ

#### 4.1 ä»»åŠ¡æ¸…å•

| # | ä»»åŠ¡ | å¤ç”¨ç‡ | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|---|------|--------|--------|------|
| 4.1 | ç”¨æˆ·è®¢é˜…ç³»ç»Ÿ | æ–°å¢ | P0 | âœ… å®Œæˆ |
| 4.2 | æ”¯ä»˜å¯¹æ¥ | æ–°å¢ | P0 | âœ… å®Œæˆ |
| 4.3 | å®‰å…¨å®¡è®¡ | å¤ç”¨æ¨¡å¼ | P0 | âœ… å®Œæˆ |
| 4.4 | æ€§èƒ½ä¼˜åŒ– | - | P1 | âœ… å®Œæˆ |
| 4.5 | Windows å®‰è£…åŒ… (NSIS) | æ–°å¢ | P0 | âœ… å®Œæˆ |
| 4.6 | è‡ªåŠ¨æ›´æ–°æœºåˆ¶ | å¤ç”¨æ¨¡å¼ | P1 | âœ… å®Œæˆ |
| 4.7 | ç”¨æˆ·æ–‡æ¡£ | æ–°å¢ | P1 | âœ… å®Œæˆ |

**Phase 4.1 å·²å®Œæˆæ–‡ä»¶:**
- `src/assistant/subscription/types.ts` - è®¢é˜…ç±»å‹å®šä¹‰ (è®¡åˆ’ã€é…é¢ã€çŠ¶æ€)
- `src/assistant/subscription/service.ts` - è®¢é˜…æœåŠ¡ (åˆ›å»ºã€æ›´æ–°ã€å–æ¶ˆã€é…é¢æ£€æŸ¥)
- `src/assistant/subscription/index.ts` - è®¢é˜…æ¨¡å—å…¥å£
- `src/gateway/server-methods/assistant-subscription.ts` - è®¢é˜… RPC æ–¹æ³• (10 ä¸ªæ¥å£)
- `apps/windows/src/renderer/hooks/useSubscription.ts` - è®¢é˜…ç®¡ç† Hook
- `apps/windows/src/renderer/components/SubscriptionView.tsx` - è®¢é˜…ç®¡ç† UI
- `apps/windows/src/renderer/components/SubscriptionView.css` - è®¢é˜…ç®¡ç†æ ·å¼
- `apps/windows/electron-builder.json` - å®Œæ•´ NSIS é…ç½®
- `apps/windows/build/installer.nsh` - è‡ªå®šä¹‰å®‰è£…è„šæœ¬
- `apps/windows/build/license.txt` - è®¸å¯åè®®
- `apps/windows/assets/README.md` - èµ„æºæ–‡ä»¶è¯´æ˜
- `apps/windows/assets/icon.ico` - åº”ç”¨å›¾æ ‡
- `apps/windows/scripts/generate-icon.ts` - å›¾æ ‡ç”Ÿæˆè„šæœ¬
- `apps/windows/scripts/build-win.ts` - æ„å»ºè„šæœ¬

**Phase 4.3 å·²å®Œæˆæ–‡ä»¶ (å®‰å…¨å®¡è®¡):**
- `apps/windows/src/main/security-utils.ts` - å®‰å…¨å·¥å…·æ¨¡å—
  - è·¯å¾„éªŒè¯å’Œæ¶ˆæ¯’ (é˜²æ­¢è·¯å¾„éå†æ”»å‡»)
  - è¾“å…¥éªŒè¯å’Œæ¶ˆæ¯’ (é˜²æ­¢ XSSã€å‘½ä»¤æ³¨å…¥)
  - å®‰å…¨çš„æ­£åˆ™è¡¨è¾¾å¼åˆ›å»º (é˜²æ­¢ ReDoS)
  - URL éªŒè¯ (é˜²æ­¢ SSRF)
  - PID éªŒè¯ (é˜²æ­¢å‘½ä»¤æ³¨å…¥)
  - å‘½ä»¤ç™½åå•æœºåˆ¶

**Phase 4.3 æ›´æ–°çš„æ–‡ä»¶:**
- `apps/windows/src/main/system-service.ts` - é›†æˆå®‰å…¨éªŒè¯
  - æ‰€æœ‰æ–‡ä»¶æ“ä½œæ·»åŠ è·¯å¾„éªŒè¯
  - æœç´¢ä½¿ç”¨å®‰å…¨æ­£åˆ™è¡¨è¾¾å¼
  - killProcess æ·»åŠ  PID éªŒè¯
  - launchApplication æ·»åŠ å‚æ•°æ¶ˆæ¯’
  - executeCommand æ·»åŠ å‘½ä»¤ç™½åå•æ£€æŸ¥

- `apps/windows/src/main/index.ts` - IPC å¤„ç†å™¨å®‰å…¨å¢å¼º
  - Gateway URL éªŒè¯
  - æ–‡ä»¶æ“ä½œå‚æ•°ç±»å‹æ£€æŸ¥
  - å†…å®¹å¤§å°é™åˆ¶
  - é…å¯¹ç æ ¼å¼éªŒè¯
  - å¤–éƒ¨ URL åè®®é™åˆ¶

**Phase 4.6 å·²å®Œæˆæ–‡ä»¶ (è‡ªåŠ¨æ›´æ–°):**
- `apps/windows/src/main/updater-service.ts` - è‡ªåŠ¨æ›´æ–°æœåŠ¡
- `apps/windows/src/renderer/hooks/useUpdater.ts` - æ›´æ–°ç®¡ç† Hook
- `apps/windows/src/renderer/components/UpdaterView.tsx` - æ›´æ–°è§†å›¾ç»„ä»¶
- `apps/windows/src/renderer/components/UpdaterView.css` - æ›´æ–°è§†å›¾æ ·å¼

**Phase 4.7 å·²å®Œæˆæ–‡ä»¶ (ç”¨æˆ·æ–‡æ¡£):**
- `apps/windows/docs/getting-started.md` - å¿«é€Ÿå…¥é—¨æŒ‡å—
- `apps/windows/docs/features.md` - åŠŸèƒ½ä½¿ç”¨è¯´æ˜
- `apps/windows/docs/faq.md` - å¸¸è§é—®é¢˜è§£ç­”
- `apps/windows/docs/changelog.md` - æ›´æ–°æ—¥å¿—

**Phase 4.2 å·²å®Œæˆæ–‡ä»¶ (æ”¯ä»˜å¯¹æ¥):**
- `src/assistant/payment/types.ts` - æ”¯ä»˜ç±»å‹å®šä¹‰
  - æ”¯ä»˜æä¾›å•† (æ”¯ä»˜å®ã€å¾®ä¿¡ã€Stripeã€æ¨¡æ‹Ÿ)
  - è®¢å•çŠ¶æ€å’Œç±»å‹
  - äº¤æ˜“è®°å½•å’Œé€€æ¬¾
  - æ”¯ä»˜å›è°ƒäº‹ä»¶
  - ä»·æ ¼è®¡ç®—

- `src/assistant/payment/service.ts` - æ”¯ä»˜æœåŠ¡æ¨¡å—
  - è®¢å•ç®¡ç† (åˆ›å»ºã€æŸ¥è¯¢ã€å–æ¶ˆ)
  - æ”¯ä»˜å¤„ç† (å‘èµ·æ”¯ä»˜ã€æŸ¥è¯¢çŠ¶æ€)
  - é€€æ¬¾å¤„ç†
  - æ¨¡æ‹Ÿæ”¯ä»˜ (å¼€å‘æµ‹è¯•)
  - ä»·æ ¼è®¡ç®—

- `src/assistant/payment/index.ts` - æ”¯ä»˜æ¨¡å—å…¥å£

- `src/gateway/server-methods/assistant-payment.ts` - æ”¯ä»˜ RPC æ–¹æ³• (15 ä¸ªæ¥å£)
  - payment.createOrder - åˆ›å»ºè®¢å•
  - payment.getOrder - è·å–è®¢å•
  - payment.getUserOrders - è·å–ç”¨æˆ·è®¢å•åˆ—è¡¨
  - payment.cancelOrder - å–æ¶ˆè®¢å•
  - payment.initiatePayment - å‘èµ·æ”¯ä»˜
  - payment.queryStatus - æŸ¥è¯¢æ”¯ä»˜çŠ¶æ€
  - payment.mockComplete - æ¨¡æ‹Ÿæ”¯ä»˜å®Œæˆ
  - payment.createRefund - ç”³è¯·é€€æ¬¾
  - payment.getRefund - è·å–é€€æ¬¾
  - payment.getOrderRefunds - è·å–è®¢å•é€€æ¬¾åˆ—è¡¨
  - payment.calculatePrice - è®¡ç®—ä»·æ ¼
  - payment.getProviders - è·å–å¯ç”¨æ”¯ä»˜æ–¹å¼
  - payment.getConfig - è·å–æ”¯ä»˜é…ç½®
  - payment.purchaseSubscription - å¿«æ·è´­ä¹°è®¢é˜…

- `apps/windows/src/renderer/hooks/usePayment.ts` - æ”¯ä»˜ç®¡ç† Hook
- `apps/windows/src/renderer/components/PaymentView.tsx` - æ”¯ä»˜é¡µé¢ç»„ä»¶
- `apps/windows/src/renderer/components/PaymentView.css` - æ”¯ä»˜é¡µé¢æ ·å¼

**Phase 4.4 å·²å®Œæˆæ–‡ä»¶ (æ€§èƒ½ä¼˜åŒ–):**
- `apps/windows/src/renderer/utils/cache.ts` - ç¼“å­˜å·¥å…·æ¨¡å—
  - LRU ç¼“å­˜å®ç° (æœ€è¿‘æœ€å°‘ä½¿ç”¨)
  - è¯·æ±‚ç¼“å­˜ (å¸¦å»é‡)
  - é˜²æŠ–/èŠ‚æµå‡½æ•°
  - Memoization å·¥å…·
  - æ‰¹é‡å¤„ç†å™¨
  - æ–‡ä»¶ç³»ç»Ÿç¼“å­˜

- `apps/windows/src/renderer/utils/performance.ts` - æ€§èƒ½ä¼˜åŒ–å·¥å…·
  - useMemoizedCallback - ç¨³å®šçš„å›è°ƒå¼•ç”¨
  - useDebounce/useDebouncedCallback - é˜²æŠ– Hook
  - useThrottle - èŠ‚æµ Hook
  - usePrevious - è·å–ä¸Šä¸€ä¸ªå€¼
  - useDeepMemo - æ·±åº¦æ¯”è¾ƒçš„ memo
  - useRenderCount - æ¸²æŸ“è®¡æ•° (è°ƒè¯•)
  - useLazyLoad - æ‡’åŠ è½½ Hook
  - useIntersectionObserver - äº¤å‰è§‚å¯Ÿå™¨
  - VirtualList - è™šæ‹Ÿåˆ—è¡¨ç»„ä»¶
  - withDeepMemo - æ·±åº¦æ¯”è¾ƒ HOC

- `apps/windows/src/renderer/components/ChatView.tsx` - ä¼˜åŒ–æ›´æ–°
  - CodeBlock ç»„ä»¶ä½¿ç”¨ React.memo + useCallback
  - SessionSidebar ç»„ä»¶ä½¿ç”¨ memo
  - MemoizedMarkdown ç»„ä»¶ç¼“å­˜ Markdown æ¸²æŸ“
  - MessageItem ç»„ä»¶ä½¿ç”¨ memo ä¼˜åŒ–åˆ—è¡¨æ¸²æŸ“
  - handleSend/handleKeyDown/formatTime ä½¿ç”¨ useCallback

- `apps/windows/src/main/system-service.ts` - ä¸»è¿›ç¨‹ä¼˜åŒ–
  - æ·»åŠ  SimpleCache ç®€å•å†…å­˜ç¼“å­˜
  - ç£ç›˜ä¿¡æ¯ç¼“å­˜ (30ç§’ TTL)
  - è¿›ç¨‹åˆ—è¡¨ç¼“å­˜ (5ç§’ TTL)
  - ç³»ç»Ÿä¿¡æ¯ç¼“å­˜ (é™æ€éƒ¨åˆ†)
  - listDirectory ä½¿ç”¨ Promise.all å¹¶è¡Œè·å–æ–‡ä»¶ä¿¡æ¯

---

### 4.1 ç›´æ¥å¤ç”¨ (100%)

| æ¨¡å— | æ–‡ä»¶ | ç”¨é€” |
|------|------|------|
| WebSocket åè®® | `src/gateway/protocol/` | é€šä¿¡åè®®å®šä¹‰ |
| TypeBox Schema | `src/gateway/protocol/schema/` | ç±»å‹éªŒè¯ |
| é…ç½®ç³»ç»Ÿ | `src/config/` | é…ç½®åŠ è½½å’ŒéªŒè¯ |
| è®¾å¤‡é…å¯¹ | `src/infra/device-pairing.ts` | äºŒç»´ç é…å¯¹ |
| è®¤è¯æœºåˆ¶ | `src/gateway/auth.ts` | JWT Token |
| å®¡è®¡æ—¥å¿— | `src/logging/` | ç»“æ„åŒ–æ—¥å¿— |
| é‡è¯•é€»è¾‘ | `src/infra/retry.ts` | ç½‘ç»œé‡è¯• |
| æ‰§è¡Œå®¡æ‰¹ | `src/infra/exec-approvals.ts` | æ•æ„Ÿæ“ä½œç¡®è®¤ |

### 4.2 æ¨¡å¼å¤ç”¨ (70-90%)

| æ¨¡å— | æ–‡ä»¶ | å¤ç”¨æ–¹å¼ |
|------|------|----------|
| å·¥å…·æ³¨å†Œ | `src/agents/tools/common.ts` | å‚æ•°è¯»å–ã€ç»“æœå¤„ç† |
| æŠ€èƒ½ç³»ç»Ÿ | `src/agents/skills/` | æŠ€èƒ½å®šä¹‰ã€å…ƒæ•°æ®ç»“æ„ |
| æ’ä»¶åŠ è½½ | `src/plugins/loader.ts` | åŠ¨æ€åŠ è½½æ¨¡å¼ |
| æ¶ˆæ¯è·¯ç”± | `src/routing/` | Session Key æ¨¡å¼ |
| ä¾èµ–æ³¨å…¥ | `src/cli/deps.ts` | DI æ¨¡å¼ |

### 4.3 å‚è€ƒå®ç° (30-50%)

| æ¨¡å— | å‚è€ƒæ¥æº | è¯´æ˜ |
|------|----------|------|
| Windows å®¢æˆ·ç«¯ | `apps/macos/` | åº”ç”¨ç»“æ„å‚è€ƒ |
| ç³»ç»Ÿæ‰˜ç›˜ | macOS èœå•æ  | UI äº¤äº’å‚è€ƒ |
| å®¢æˆ·ç«¯ UI | - | éœ€è¦å…¨æ–°è®¾è®¡ |

---

## 5. æŠ€æœ¯å†³ç­–

### 5.1 ç¡®å®šå¤ç”¨

| å†³ç­– | ç†ç”± |
|------|------|
| å¤ç”¨ Gateway æ¶æ„ | ç”Ÿäº§çº§ç¨³å®šï¼ŒåŠŸèƒ½å®Œå–„ |
| å¤ç”¨ TypeBox Schema | ç±»å‹å®‰å…¨ï¼Œè¿è¡Œæ—¶éªŒè¯ |
| å¤ç”¨ Pi Agent Core | AI èƒ½åŠ›æˆç†Ÿï¼Œå·¥å…·è°ƒç”¨å®Œå–„ |
| å¤ç”¨æ’ä»¶ç³»ç»Ÿ | æŠ€èƒ½ç³»ç»Ÿå¤©ç„¶åŸºç¡€ |
| å¤ç”¨é…ç½®ç³»ç»Ÿ | YAML + çƒ­é‡è½½ï¼Œç”¨æˆ·å‹å¥½ |

### 5.2 éœ€è¦æ–°å¢

| æ¨¡å— | ç†ç”± |
|------|------|
| Windows Electron å®¢æˆ·ç«¯ | ç›®æ ‡å¹³å° |
| æœåŠ¡ç«¯æŠ€èƒ½åŠ è½½ | æ ¸å¿ƒä¸šåŠ¡éœ€æ±‚ |
| æŠ€èƒ½å•†åº— | å•†ä¸šæ¨¡å¼éœ€æ±‚ |
| è®¡è´¹ç³»ç»Ÿ | å•†ä¸šæ¨¡å¼éœ€æ±‚ |

### 5.3 æ¶æ„çº¦æŸ

1. **ä¿æŒå‘åå…¼å®¹**: ä¸ç ´åç°æœ‰ OpenClaw åŠŸèƒ½
2. **æ¨¡å—åŒ–æ‰©å±•**: æ–°åŠŸèƒ½ä½œä¸ºç‹¬ç«‹ package
3. **ç±»å‹å®‰å…¨**: ç»§ç»­ä½¿ç”¨ TypeScript + TypeBox
4. **é…ç½®é©±åŠ¨**: æ–°åŠŸèƒ½é€šè¿‡é…ç½®å¯ç”¨

---

## 6. é£é™©ä¸ç¼“è§£

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|------|------|----------|
| Windows API å…¼å®¹æ€§ | ä¸­ | å……åˆ†æµ‹è¯• Win10/11 |
| æŠ€èƒ½æ²™ç®±å®‰å…¨ | é«˜ | å¤ç”¨ç°æœ‰æ²™ç®± + å¢å¼º |
| ä¸ç°æœ‰ä»£ç å†²çª | ä¸­ | ç‹¬ç«‹ packageï¼Œæœ€å°ä¾µå…¥ |
| Electron åŒ…ä½“ç§¯ | ä½ | ä¼˜åŒ–ä¾èµ–ï¼Œå»¶è¿ŸåŠ è½½ |

---

## 7. é‡Œç¨‹ç¢‘æ€»ç»“

| é‡Œç¨‹ç¢‘ | ç›®æ ‡ | å¤ç”¨ç‡ | æ–°å¢ä»£ç ä¼°ç®— | çŠ¶æ€ |
|--------|------|--------|--------------|------|
| M1 Phase 1 | åŸºç¡€æ¶æ„ | ~80% | ~3000 è¡Œ | âœ… å…¨éƒ¨å®Œæˆ (7/7) |
| M2 Phase 2 | æ ¸å¿ƒåŠŸèƒ½ | ~60% | ~5000 è¡Œ | âœ… å…¨éƒ¨å®Œæˆ (7/7) |
| M3 Phase 3 | æŠ€èƒ½ç³»ç»Ÿ | ~50% | ~6000 è¡Œ | âœ… å…¨éƒ¨å®Œæˆ (8/8) |
| M4 Phase 4 | å•†ä¸šåŒ– | ~30% | ~4000 è¡Œ | âœ… å…¨éƒ¨å®Œæˆ (7/7) |
| **æ€»è®¡** | | **~55%** | **~18000 è¡Œ** | **ğŸ‰ 100% å®Œæˆ** |

### 7.1 å½“å‰è¿›åº¦æ¦‚è§ˆ

```
Phase 1 åŸºç¡€æ¶æ„é€‚é… â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (7/7 å®Œæˆ)
Phase 2 æ ¸å¿ƒåŠŸèƒ½å¼€å‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (7/7 å®Œæˆ)
Phase 3 æŠ€èƒ½ç³»ç»Ÿå¼€å‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (8/8 å®Œæˆ)
Phase 4 å•†ä¸šåŒ–ä¸ä¼˜åŒ– â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (7/7 å®Œæˆ)

æ€»ä½“è¿›åº¦:            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (29/29 å®Œæˆ) ğŸ‰
```

### 7.2 å·²å®Œæˆçš„æ ¸å¿ƒæ–‡ä»¶

**Gateway å±‚ (æœåŠ¡ç«¯)**
- `src/gateway/server-methods/assistant.ts` - åŠ©æ‰‹ RPC æ–¹æ³•
- `src/gateway/server-methods/assistant-skills.ts` - æŠ€èƒ½ RPC æ–¹æ³•
- `src/gateway/server-methods/assistant-audit.ts` - å®¡è®¡æ—¥å¿— RPC æ–¹æ³•
- `src/gateway/server-methods/assistant-subscription.ts` - è®¢é˜… RPC æ–¹æ³•
- `src/agents/tools/windows-assistant-tools.ts` - Windows å·¥å…·é›†

**å®¡è®¡æ—¥å¿—ç³»ç»Ÿ**
- `src/assistant/audit/types.ts` - å®¡è®¡æ—¥å¿—ç±»å‹å®šä¹‰
- `src/assistant/audit/service.ts` - å®¡è®¡æ—¥å¿—æœåŠ¡
- `src/assistant/audit/index.ts` - å®¡è®¡æ—¥å¿—æ¨¡å—å…¥å£

**æŠ€èƒ½ç³»ç»Ÿ**
- `src/assistant/skills/types.ts` - æŠ€èƒ½ç±»å‹å®šä¹‰
- `src/assistant/skills/loader.ts` - æŠ€èƒ½åŠ è½½å™¨
- `src/assistant/skills/executor.ts` - æŠ€èƒ½æ‰§è¡Œå™¨

**è®¢é˜…ç³»ç»Ÿ**
- `src/assistant/subscription/types.ts` - è®¢é˜…ç±»å‹å®šä¹‰
- `src/assistant/subscription/service.ts` - è®¢é˜…æœåŠ¡
- `src/assistant/subscription/index.ts` - è®¢é˜…æ¨¡å—å…¥å£

**Windows å®¢æˆ·ç«¯ - Main è¿›ç¨‹**
- `apps/windows/src/main/index.ts` - ä¸»è¿›ç¨‹å…¥å£
- `apps/windows/src/main/gateway-client.ts` - WebSocket å®¢æˆ·ç«¯
- `apps/windows/src/main/tray-manager.ts` - ç³»ç»Ÿæ‰˜ç›˜
- `apps/windows/src/main/system-service.ts` - ç³»ç»ŸæœåŠ¡
- `apps/windows/src/main/device-pairing-service.ts` - è®¾å¤‡é…å¯¹æœåŠ¡
- `apps/windows/src/preload/index.ts` - é¢„åŠ è½½è„šæœ¬
- `apps/windows/electron-builder.json` - æ‰“åŒ…é…ç½®

**Windows å®¢æˆ·ç«¯ - Renderer è¿›ç¨‹**
- `apps/windows/src/renderer/App.tsx` - ä¸»åº”ç”¨ç»„ä»¶
- `apps/windows/src/renderer/components/ChatView.tsx` - å¯¹è¯è§†å›¾
- `apps/windows/src/renderer/components/FilesView.tsx` - æ–‡ä»¶ç®¡ç†
- `apps/windows/src/renderer/components/SystemView.tsx` - ç³»ç»Ÿç›‘æ§
- `apps/windows/src/renderer/components/SkillsView.tsx` - æŠ€èƒ½ç®¡ç†
- `apps/windows/src/renderer/components/SkillStoreView.tsx` - æŠ€èƒ½å•†åº—
- `apps/windows/src/renderer/components/SettingsView.tsx` - è®¾ç½®é¡µé¢
- `apps/windows/src/renderer/components/SubscriptionView.tsx` - è®¢é˜…ç®¡ç†
- `apps/windows/src/renderer/components/Sidebar.tsx` - ä¾§è¾¹æ 
- `apps/windows/src/renderer/components/ConfirmDialog.tsx` - ç¡®è®¤å¯¹è¯æ¡†
- `apps/windows/src/renderer/components/TitleBar.tsx` - æ ‡é¢˜æ 

**Hooks**
- `useChatHistory.ts` - èŠå¤©å†å²æŒä¹…åŒ–
- `useFileManager.ts` - æ–‡ä»¶ç®¡ç†
- `useSystemMonitor.ts` - ç³»ç»Ÿç›‘æ§
- `useSkills.ts` - æŠ€èƒ½ç®¡ç†
- `useSkillStore.ts` - æŠ€èƒ½å•†åº—
- `useSubscription.ts` - è®¢é˜…ç®¡ç†
- `useSettings.ts` - è®¾ç½®ç®¡ç†
- `useConnectionStatus.ts` - è¿æ¥çŠ¶æ€
- `useConfirmRequests.ts` - ç¡®è®¤è¯·æ±‚
- `useDevicePairing.ts` - è®¾å¤‡é…å¯¹
- `useAuditLog.ts` - å®¡è®¡æ—¥å¿—

### 7.3 å¾…å®Œæˆçš„å…³é”®ä»»åŠ¡

**é«˜ä¼˜å…ˆçº§ (P0)**
~~1. Electron æ‰“åŒ…é…ç½® (Phase 1.7)~~ âœ…
~~2. è®¾å¤‡é…å¯¹æµç¨‹é›†æˆ (Phase 1.3)~~ âœ…
~~3. è®¤è¯æœºåˆ¶é›†æˆ (Phase 1.4)~~ âœ…

**ä¸­ä¼˜å…ˆçº§ (P1)**
~~1. å®¡è®¡æ—¥å¿—ç³»ç»Ÿé›†æˆ (Phase 2.7)~~ âœ…
~~2. å†…ç½®æŠ€èƒ½å¼€å‘ (Phase 3.5)~~ âœ… æ–‡ä»¶æ•´ç†æŠ€èƒ½å·²å®Œæˆ
~~3. å†…ç½®æŠ€èƒ½å¼€å‘ï¼šç³»ç»Ÿæ¸…ç† (Phase 3.6)~~ âœ… ç³»ç»Ÿæ¸…ç†æŠ€èƒ½å·²å®Œæˆ
~~4. æŠ€èƒ½å•†åº—åç«¯ (Phase 3.7)~~ âœ…
~~5. æŠ€èƒ½å•†åº—å‰ç«¯ (Phase 3.8)~~ âœ… æŠ€èƒ½å•†åº—å‰ç«¯å·²å®Œæˆ

**ç›¸æ¯”ä»é›¶å¼€å§‹é¢„ä¼° (40000+ è¡Œ)ï¼Œå¤ç”¨ç°æœ‰æ¶æ„å¯èŠ‚çœçº¦ 55% çš„å¼€å‘å·¥ä½œé‡ã€‚**

---

## 8. ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|----------|
| v2.0 | 2026-02-06 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºäºç°æœ‰æ¶æ„é‡æ„è®¡åˆ’ |
| v2.1 | 2026-02-06 | æ›´æ–°è¿›åº¦ï¼šPhase 1-2 åŸºæœ¬å®Œæˆï¼ŒPhase 3 è¿›è¡Œä¸­ |
| v2.2 | 2026-02-06 | Phase 1 å…¨éƒ¨å®Œæˆï¼šElectron æ‰“åŒ…ã€è®¾å¤‡é…å¯¹ã€è®¤è¯æœºåˆ¶ï¼›æ–‡ä»¶æ•´ç†æŠ€èƒ½å®Œæˆ |
| v2.3 | 2026-02-06 | Phase 3 å…¨éƒ¨å®Œæˆï¼šæŠ€èƒ½å•†åº—å‰ç«¯å¼€å‘å®Œæˆï¼ŒåŒ…å«æ ‡ç­¾é¡µåˆ‡æ¢ã€åˆ†ç±»ç­›é€‰ã€æœç´¢åŠŸèƒ½ |
| v2.4 | 2026-02-06 | Phase 2.7 å®Œæˆï¼šå®¡è®¡æ—¥å¿—ç³»ç»Ÿé›†æˆï¼ŒåŒ…å«ç±»å‹å®šä¹‰ã€æœåŠ¡æ¨¡å—ã€RPCæ–¹æ³•ã€å‰ç«¯UI |
| v2.5 | 2026-02-06 | Phase 4.5 å®Œæˆï¼šWindows NSIS å®‰è£…åŒ…é…ç½®ï¼ŒåŒ…å«è‡ªå®šä¹‰å®‰è£…è„šæœ¬ã€è®¸å¯åè®®ã€å›¾æ ‡ç”Ÿæˆ |
| v2.6 | 2026-02-07 | Phase 4.1 å®Œæˆï¼šç”¨æˆ·è®¢é˜…ç³»ç»Ÿï¼ŒåŒ…å«è®¢é˜…è®¡åˆ’ã€é…é¢ç®¡ç†ã€ä½¿ç”¨é‡ç»Ÿè®¡ã€è®¢é˜…ç®¡ç†UI |
| v2.7 | 2026-02-07 | Phase 4.6 å®Œæˆï¼šè‡ªåŠ¨æ›´æ–°æœºåˆ¶ï¼ŒåŒ…å« electron-updater é›†æˆã€æ›´æ–°æœåŠ¡ã€æ›´æ–°UIã€è®¾ç½®é¡µé¢é›†æˆ |
| v2.8 | 2026-02-07 | Phase 4.7 å®Œæˆï¼šç”¨æˆ·æ–‡æ¡£ï¼ŒåŒ…å«å¿«é€Ÿå…¥é—¨æŒ‡å—ã€åŠŸèƒ½è¯´æ˜ã€FAQã€æ›´æ–°æ—¥å¿— |
| v2.9 | 2026-02-07 | Phase 4.3 å®Œæˆï¼šå®‰å…¨å®¡è®¡ï¼ŒåŒ…å«å®‰å…¨å·¥å…·æ¨¡å—ã€è·¯å¾„éªŒè¯ã€è¾“å…¥æ¶ˆæ¯’ã€å‘½ä»¤ç™½åå•ã€IPC å®‰å…¨å¢å¼º |
| v3.0 | 2026-02-07 | Phase 4.2 å®Œæˆï¼šæ”¯ä»˜å¯¹æ¥ï¼ŒåŒ…å«æ”¯ä»˜ç±»å‹å®šä¹‰ã€æ”¯ä»˜æœåŠ¡æ¨¡å—ã€15ä¸ªRPCæ¥å£ã€æ”¯ä»˜é¡µé¢UI |
| v3.1 | 2026-02-07 | Phase 4.4 å®Œæˆï¼šæ€§èƒ½ä¼˜åŒ–ï¼ŒåŒ…å«æ¸²æŸ“è¿›ç¨‹ä¼˜åŒ–(React.memo/useMemo/useCallback)ã€ä¸»è¿›ç¨‹ä¼˜åŒ–(ç¼“å­˜/å¹¶è¡Œå¤„ç†)ã€å·¥å…·æ¨¡å—(cache.ts/performance.ts) |

---

*â€” æ–‡æ¡£ç»“æŸ â€”*

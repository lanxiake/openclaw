# Agent ä»»åŠ¡çœ‹æ¿è®¾è®¡æ–¹æ¡ˆ

## 1. åŠŸèƒ½æ¦‚è¿°

ä»»åŠ¡çœ‹æ¿æ˜¯ä¸€ä¸ªå®æ—¶å¯è§†åŒ–ç•Œé¢ï¼Œç”¨äºå±•ç¤º OpenClaw æ™ºèƒ½ä½“çš„è®¡åˆ’ã€æ‰§è¡Œè¿‡ç¨‹å’Œè¡Œä¸ºçŠ¶æ€ã€‚å¸®åŠ©ç”¨æˆ·äº†è§£ç³»ç»Ÿçš„å·¥ä½œæµç¨‹å’Œè¿è¡ŒçŠ¶æ€ã€‚

### 1.1 æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½ | æè¿° |
|------|------|
| **ä»»åŠ¡æµæ°´çº¿** | å±•ç¤ºå½“å‰æ‰§è¡Œçš„ä»»åŠ¡é˜Ÿåˆ—å’ŒçŠ¶æ€ |
| **æ‰§è¡Œæ—¶é—´çº¿** | æŒ‰æ—¶é—´é¡ºåºå±•ç¤º agent çš„è¡Œä¸ºå†å² |
| **å·¥å…·è°ƒç”¨å¯è§†åŒ–** | å®æ—¶æ˜¾ç¤ºå·¥å…·çš„è°ƒç”¨ã€å‚æ•°å’Œç»“æœ |
| **æ€è€ƒè¿‡ç¨‹å±•ç¤º** | å±•ç¤º agent çš„æ¨ç†å’Œå†³ç­–è¿‡ç¨‹ |
| **çŠ¶æ€ç›‘æ§** | æ˜¾ç¤º agent çš„è¿è¡ŒçŠ¶æ€ã€èµ„æºä½¿ç”¨ç­‰ |

### 1.2 ç”¨æˆ·ä»·å€¼

- **é€æ˜åº¦**: ç”¨æˆ·å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ° agent åœ¨åšä»€ä¹ˆ
- **è°ƒè¯•**: å¼€å‘è€…å¯ä»¥è¿½è¸ªé—®é¢˜å’Œä¼˜åŒ–æ€§èƒ½
- **ä¿¡ä»»**: é€šè¿‡å¯è§†åŒ–å»ºç«‹ç”¨æˆ·å¯¹ AI ç³»ç»Ÿçš„ä¿¡ä»»
- **å­¦ä¹ **: å¸®åŠ©ç”¨æˆ·ç†è§£ AI çš„å·¥ä½œæ–¹å¼

## 2. æŠ€æœ¯æ¶æ„

### 2.1 æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Gateway Server                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Agent Runnerâ”‚â”€â”€â”€â–¶â”‚ Event Emitterâ”‚â”€â”€â”€â–¶â”‚ WebSocket Broadcast â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ WebSocket Events
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Control UI                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Event Handlerâ”‚â”€â”€â”€â–¶â”‚ State Store â”‚â”€â”€â”€â–¶â”‚ Dashboard Component â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 äº‹ä»¶ç±»å‹æ‰©å±•

åŸºäºç°æœ‰çš„ `AgentEventPayload`ï¼Œæ‰©å±•ä»¥ä¸‹äº‹ä»¶æµï¼š

```typescript
// æ–°å¢äº‹ä»¶æµç±»å‹
type DashboardEventStream =
  | "lifecycle"    // ç”Ÿå‘½å‘¨æœŸï¼ˆå·²æœ‰ï¼‰
  | "tool"         // å·¥å…·æ‰§è¡Œï¼ˆå·²æœ‰ï¼‰
  | "assistant"    // åŠ©æ‰‹å“åº”ï¼ˆå·²æœ‰ï¼‰
  | "planning"     // è®¡åˆ’é˜¶æ®µï¼ˆæ–°å¢ï¼‰
  | "reasoning"    // æ¨ç†è¿‡ç¨‹ï¼ˆæ–°å¢ï¼‰
  | "task"         // ä»»åŠ¡çŠ¶æ€ï¼ˆæ–°å¢ï¼‰
  | "resource";    // èµ„æºä½¿ç”¨ï¼ˆæ–°å¢ï¼‰

// è®¡åˆ’äº‹ä»¶
interface PlanningEvent {
  phase: "start" | "step" | "complete";
  plan?: {
    goal: string;
    steps: Array<{
      id: string;
      description: string;
      status: "pending" | "active" | "completed" | "failed";
      estimatedDuration?: number;
    }>;
  };
  currentStep?: string;
}

// æ¨ç†äº‹ä»¶
interface ReasoningEvent {
  type: "thought" | "decision" | "evaluation";
  content: string;
  confidence?: number;
  alternatives?: string[];
}

// ä»»åŠ¡äº‹ä»¶
interface TaskEvent {
  taskId: string;
  action: "created" | "started" | "progress" | "completed" | "failed";
  task: {
    id: string;
    name: string;
    description: string;
    status: TaskStatus;
    progress?: number;
    startedAt?: number;
    completedAt?: number;
    error?: string;
  };
}
```

### 2.3 çŠ¶æ€ç®¡ç†

```typescript
// Dashboard çŠ¶æ€ç»“æ„
interface DashboardState {
  // å½“å‰è¿è¡Œ
  currentRun: {
    runId: string;
    sessionKey: string;
    startedAt: number;
    status: "running" | "completed" | "failed";
  } | null;

  // ä»»åŠ¡åˆ—è¡¨
  tasks: Map<string, Task>;
  taskOrder: string[];

  // è®¡åˆ’
  currentPlan: Plan | null;

  // æ—¶é—´çº¿äº‹ä»¶
  timeline: TimelineEvent[];
  timelineMaxSize: number; // é»˜è®¤ 200

  // å·¥å…·è°ƒç”¨
  toolCalls: Map<string, ToolCall>;
  activeToolCalls: Set<string>;

  // æ¨ç†å†å²
  reasoningHistory: ReasoningEntry[];

  // èµ„æºç›‘æ§
  resources: {
    tokensUsed: number;
    tokensLimit: number;
    apiCalls: number;
    duration: number;
  };
}
```

## 3. UI ç»„ä»¶è®¾è®¡

### 3.1 ç»„ä»¶å±‚æ¬¡

```
dashboard/
â”œâ”€â”€ dashboard-view.ts          # ä¸»è§†å›¾å®¹å™¨
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ task-board.ts          # ä»»åŠ¡çœ‹æ¿ï¼ˆçœ‹æ¿è§†å›¾ï¼‰
â”‚   â”œâ”€â”€ timeline-view.ts       # æ—¶é—´çº¿è§†å›¾
â”‚   â”œâ”€â”€ tool-inspector.ts      # å·¥å…·è°ƒç”¨æ£€æŸ¥å™¨
â”‚   â”œâ”€â”€ reasoning-panel.ts     # æ¨ç†è¿‡ç¨‹é¢æ¿
â”‚   â”œâ”€â”€ plan-visualizer.ts     # è®¡åˆ’å¯è§†åŒ–
â”‚   â”œâ”€â”€ resource-monitor.ts    # èµ„æºç›‘æ§
â”‚   â””â”€â”€ status-bar.ts          # çŠ¶æ€æ 
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ dashboard.ts           # Dashboard æ§åˆ¶å™¨
â””â”€â”€ styles/
    â””â”€â”€ dashboard.css          # æ ·å¼
```

### 3.2 ä»»åŠ¡çœ‹æ¿å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Agent Dashboard                              [Session: main] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   Pending   â”‚ â”‚   Active    â”‚ â”‚  Completed  â”‚ â”‚   Failed    â”‚ â”‚
â”‚ â”‚    (3)      â”‚ â”‚    (1)      â”‚ â”‚    (5)      â”‚ â”‚    (0)      â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚             â”‚ â”‚
â”‚ â”‚ â”‚ Task 4  â”‚ â”‚ â”‚ â”‚ Task 3  â”‚ â”‚ â”‚ â”‚ Task 1  â”‚ â”‚ â”‚             â”‚ â”‚
â”‚ â”‚ â”‚ Read... â”‚ â”‚ â”‚ â”‚ Edit... â”‚ â”‚ â”‚ â”‚ Search..â”‚ â”‚ â”‚             â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ â”‚ â”‚ â”‚ â”‚ âœ“ Done  â”‚ â”‚ â”‚             â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚             â”‚ â”‚
â”‚ â”‚ â”‚ Task 5  â”‚ â”‚ â”‚             â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚             â”‚ â”‚
â”‚ â”‚ â”‚ Write...â”‚ â”‚ â”‚             â”‚ â”‚ â”‚ Task 2  â”‚ â”‚ â”‚             â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚             â”‚ â”‚ â”‚ âœ“ Done  â”‚ â”‚ â”‚             â”‚ â”‚
â”‚ â”‚             â”‚ â”‚             â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Timeline                                                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ 10:23:45 â— Agent started                                  â”‚   â”‚
â”‚ â”‚ 10:23:46 â— Planning: Analyzing user request...            â”‚   â”‚
â”‚ â”‚ 10:23:47 â—‰ Tool: Glob("**/*.ts") â†’ 42 files               â”‚   â”‚
â”‚ â”‚ 10:23:48 â—‰ Tool: Read("src/index.ts") â†’ 150 lines         â”‚   â”‚
â”‚ â”‚ 10:23:50 â— Reasoning: Found relevant code in...           â”‚   â”‚
â”‚ â”‚ 10:23:52 â—‰ Tool: Edit("src/index.ts") â†’ Success           â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Resources: Tokens 12.5k/200k â”‚ API Calls: 8 â”‚ Duration: 45s    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 æ—¶é—´çº¿è§†å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Timeline View                                    [Filter â–¼]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  10:23:45 â”€â—â”€ Agent Started                                     â”‚
â”‚            â”‚  Session: main, Model: claude-sonnet-4.5           â”‚
â”‚            â”‚                                                    â”‚
â”‚  10:23:46 â”€â—â”€ Planning Phase                                    â”‚
â”‚            â”‚  Goal: Implement user authentication               â”‚
â”‚            â”‚  Steps: 5 planned                                  â”‚
â”‚            â”‚                                                    â”‚
â”‚  10:23:47 â”€â—‰â”€ Tool: Glob                                        â”‚
â”‚            â”‚  Pattern: "src/**/*.ts"                            â”‚
â”‚            â”‚  Result: 42 files found                            â”‚
â”‚            â”‚  Duration: 120ms                                   â”‚
â”‚            â”‚                                                    â”‚
â”‚  10:23:48 â”€â—‰â”€ Tool: Read                                        â”‚
â”‚            â”‚  File: src/auth/index.ts                           â”‚
â”‚            â”‚  Lines: 1-150                                      â”‚
â”‚            â”‚  Duration: 45ms                                    â”‚
â”‚            â”‚                                                    â”‚
â”‚  10:23:50 â”€â—â”€ Reasoning                                         â”‚
â”‚            â”‚  "The existing auth module uses JWT tokens.        â”‚
â”‚            â”‚   I should extend the AuthService class..."        â”‚
â”‚            â”‚                                                    â”‚
â”‚  10:23:52 â”€â—‰â”€ Tool: Edit                                        â”‚
â”‚            â”‚  File: src/auth/service.ts                         â”‚
â”‚            â”‚  Changes: +25 lines, -3 lines                      â”‚
â”‚            â”‚  Duration: 89ms                                    â”‚
â”‚            â”‚                                                    â”‚
â”‚  10:23:55 â”€â—â”€ Agent Completed                                   â”‚
â”‚               Duration: 10s, Tokens: 12,500                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 å·¥å…·è°ƒç”¨æ£€æŸ¥å™¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tool Inspector                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â—‰ Edit                                          [Completed] â”‚ â”‚
â”‚ â”‚   File: src/auth/service.ts                                 â”‚ â”‚
â”‚ â”‚   Duration: 89ms                                            â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Arguments:                                                  â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ {                                                       â”‚ â”‚ â”‚
â”‚ â”‚ â”‚   "file_path": "src/auth/service.ts",                   â”‚ â”‚ â”‚
â”‚ â”‚ â”‚   "old_string": "class AuthService {",                  â”‚ â”‚ â”‚
â”‚ â”‚ â”‚   "new_string": "class AuthService implements IAuth {", â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ }                                                       â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Result:                                                     â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ {                                                       â”‚ â”‚ â”‚
â”‚ â”‚ â”‚   "success": true,                                      â”‚ â”‚ â”‚
â”‚ â”‚ â”‚   "message": "File updated successfully"                â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ }                                                       â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4. å®ç°è®¡åˆ’

### Phase 1: åŸºç¡€æ¡†æ¶ï¼ˆMVPï¼‰

**ç›®æ ‡**: å®ç°åŸºæœ¬çš„ä»»åŠ¡çœ‹æ¿å’Œæ—¶é—´çº¿è§†å›¾

**ä»»åŠ¡**:
1. åˆ›å»º Dashboard è§†å›¾ç»„ä»¶
2. å®ç°æ—¶é—´çº¿äº‹ä»¶æ”¶é›†å’Œå±•ç¤º
3. æ·»åŠ å·¥å…·è°ƒç”¨åˆ—è¡¨
4. é›†æˆåˆ°ç°æœ‰å¯¼èˆª

**æ–‡ä»¶**:
- `ui/src/ui/views/dashboard.ts`
- `ui/src/ui/controllers/dashboard.ts`
- `ui/src/ui/app-dashboard.ts`

### Phase 2: ä»»åŠ¡çœ‹æ¿

**ç›®æ ‡**: å®ç°çœ‹æ¿å¼ä»»åŠ¡ç®¡ç†è§†å›¾

**ä»»åŠ¡**:
1. åˆ›å»ºä»»åŠ¡å¡ç‰‡ç»„ä»¶
2. å®ç°æ‹–æ‹½æ’åºï¼ˆå¯é€‰ï¼‰
3. æ·»åŠ ä»»åŠ¡çŠ¶æ€è¿‡æ»¤
4. å®ç°ä»»åŠ¡è¯¦æƒ…é¢æ¿

**æ–‡ä»¶**:
- `ui/src/ui/views/dashboard/task-board.ts`
- `ui/src/ui/views/dashboard/task-card.ts`

### Phase 3: æ¨ç†å¯è§†åŒ–

**ç›®æ ‡**: å±•ç¤º agent çš„æ€è€ƒå’Œå†³ç­–è¿‡ç¨‹

**ä»»åŠ¡**:
1. æ‰©å±• agent äº‹ä»¶ä»¥åŒ…å«æ¨ç†ä¿¡æ¯
2. åˆ›å»ºæ¨ç†é¢æ¿ç»„ä»¶
3. å®ç°æ€è€ƒè¿‡ç¨‹çš„æµå¼å±•ç¤º

**æ–‡ä»¶**:
- `src/agents/pi-embedded-subscribe.handlers.reasoning.ts`
- `ui/src/ui/views/dashboard/reasoning-panel.ts`

### Phase 4: èµ„æºç›‘æ§

**ç›®æ ‡**: å®æ—¶æ˜¾ç¤ºèµ„æºä½¿ç”¨æƒ…å†µ

**ä»»åŠ¡**:
1. æ”¶é›† token ä½¿ç”¨ã€API è°ƒç”¨ç­‰æŒ‡æ ‡
2. åˆ›å»ºèµ„æºç›‘æ§ç»„ä»¶
3. æ·»åŠ ä½¿ç”¨é‡è­¦å‘Š

**æ–‡ä»¶**:
- `ui/src/ui/views/dashboard/resource-monitor.ts`

## 5. API è®¾è®¡

### 5.1 æ–°å¢ Gateway äº‹ä»¶

```typescript
// æ·»åŠ åˆ° GATEWAY_EVENTS
"dashboard.task",      // ä»»åŠ¡çŠ¶æ€æ›´æ–°
"dashboard.plan",      // è®¡åˆ’æ›´æ–°
"dashboard.reasoning", // æ¨ç†äº‹ä»¶
"dashboard.resource",  // èµ„æºä½¿ç”¨æ›´æ–°
```

### 5.2 Dashboard è®¢é˜…

```typescript
// UI ç«¯è®¢é˜… dashboard äº‹ä»¶
interface DashboardSubscription {
  subscribe(options: {
    sessionKey?: string;
    runId?: string;
    streams?: DashboardEventStream[];
  }): void;

  unsubscribe(): void;
}
```

## 6. é…ç½®é€‰é¡¹

```typescript
// openclaw.json
{
  "dashboard": {
    "enabled": true,
    "timeline": {
      "maxEvents": 200,
      "retentionMinutes": 60
    },
    "toolInspector": {
      "showArguments": true,
      "showResults": true,
      "truncateAt": 1000
    },
    "reasoning": {
      "enabled": true,
      "verbosity": "normal" // "minimal" | "normal" | "verbose"
    }
  }
}
```

## 7. å®‰å…¨è€ƒè™‘

1. **æ•æ„Ÿä¿¡æ¯è¿‡æ»¤**: å·¥å…·å‚æ•°å’Œç»“æœä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼ˆAPI keysã€å¯†ç ç­‰ï¼‰åº”è¢«é®è”½
2. **è®¿é—®æ§åˆ¶**: Dashboard åº”éµå¾ªç°æœ‰çš„ gateway è®¤è¯æœºåˆ¶
3. **æ•°æ®ä¿ç•™**: æ—¶é—´çº¿æ•°æ®åº”æœ‰åˆç†çš„ä¿ç•™æœŸé™ï¼Œé¿å…å†…å­˜æ³„æ¼

## 8. æ€§èƒ½è€ƒè™‘

1. **äº‹ä»¶èŠ‚æµ**: é«˜é¢‘äº‹ä»¶ï¼ˆå¦‚æµå¼è¾“å‡ºï¼‰åº”è¿›è¡ŒèŠ‚æµ
2. **è™šæ‹Ÿæ»šåŠ¨**: é•¿æ—¶é—´çº¿åº”ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
3. **æ‡’åŠ è½½**: å·¥å…·è¯¦æƒ…åº”æŒ‰éœ€åŠ è½½
4. **å†…å­˜é™åˆ¶**: è®¾ç½®æœ€å¤§äº‹ä»¶æ•°é‡ï¼Œè‡ªåŠ¨æ¸…ç†æ—§äº‹ä»¶

## 9. æœªæ¥æ‰©å±•

- **å¤š Agent è§†å›¾**: æ”¯æŒåŒæ—¶ç›‘æ§å¤šä¸ª agent
- **å†å²å›æ”¾**: å›æ”¾å†å²æ‰§è¡Œè¿‡ç¨‹
- **æ€§èƒ½åˆ†æ**: è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
- **è‡ªå®šä¹‰ä»ªè¡¨æ¿**: ç”¨æˆ·å¯è‡ªå®šä¹‰æ˜¾ç¤ºçš„ç»„ä»¶
- **å¯¼å‡ºåŠŸèƒ½**: å¯¼å‡ºæ‰§è¡Œæ—¥å¿—å’Œç»Ÿè®¡æ•°æ®

================================================================
  OpenClaw Windows 打包方案测试指南
================================================================

本目录包含三种 Windows EXE 打包方案的测试项目：

1. PKG 打包 (pkg-test/)
2. NEXE 打包 (nexe-test/)
3. Electron 打包 (electron-test/)

================================================================
测试环境要求
================================================================

- Node.js >= 22.0.0
- npm 或 pnpm
- Windows 10/11
- 至少 2GB 可用磁盘空间

================================================================
方案 1: PKG 打包测试
================================================================

目录: pkg-test/

特点:
✅ 官方 Vercel 维护，稳定可靠
✅ 单文件可执行，包含 Node 运行时
✅ 支持资源文件打包
✅ 适合完整的 Node.js 应用

测试步骤:
1. cd pkg-test
2. npm install fs-extra  (安装依赖)
3. node build.js         (执行打包)
4. dist\openclaw.exe     (测试运行)

预期输出:
- openclaw.exe (约 50-80MB)
- 显示系统信息和配置文件读取结果

优点:
+ 打包速度适中
+ 文件体积合理
+ 资源文件支持完善
+ 生态成熟，问题少

缺点:
- 首次打包需要下载 Node 基础包
- 相比 nexe 文件稍大

================================================================
方案 2: NEXE 打包测试
================================================================

目录: nexe-test/

特点:
✅ 轻量级打包工具
✅ 打包速度快
✅ 支持资源内嵌
✅ 适合简单应用

测试步骤:
1. cd nexe-test
2. npm install fs-extra  (安装依赖)
3. node build.js         (执行打包)
4. dist\openclaw.exe     (测试运行)

预期输出:
- openclaw.exe (约 40-60MB)
- 显示 ASCII Logo 和系统信息

优点:
+ 打包速度最快
+ 文件体积较小
+ 配置简单

缺点:
- 资源文件处理较复杂
- 大型项目可能有兼容性问题
- 社区不如 pkg 活跃

================================================================
方案 3: Electron 打包测试
================================================================

目录: electron-test/

特点:
✅ 完整的桌面应用框架
✅ 带 GUI 界面
✅ 支持系统托盘
✅ 跨平台支持完善

测试步骤:
1. cd electron-test
2. node build.js              (安装依赖并打包)
   或
   npm install electron electron-builder --save-dev
   npm run build

3. 测试方式:
   - npm start                (开发模式)
   - dist\win-unpacked\*.exe  (绿色版)
   - 安装 dist 中的安装包     (完整安装版)

预期输出:
- 桌面窗口应用 (约 150-200MB)
- 漂亮的 GUI 界面
- 系统托盘图标
- NSIS 安装包

优点:
+ 完整的桌面应用体验
+ UI 界面美观
+ 生态系统完善
+ 支持自动更新

缺点:
- 文件体积最大
- 打包时间最长
- 对于纯 CLI 工具来说过重

================================================================
三种方案对比
================================================================

维度          | PKG       | NEXE      | Electron
---------------------------------------------------------
文件大小      | 50-80MB   | 40-60MB   | 150-200MB
打包速度      | 中等      | 快        | 慢
易用性        | ⭐⭐⭐⭐    | ⭐⭐⭐⭐⭐   | ⭐⭐⭐
稳定性        | ⭐⭐⭐⭐⭐   | ⭐⭐⭐     | ⭐⭐⭐⭐⭐
生态支持      | ⭐⭐⭐⭐⭐   | ⭐⭐⭐     | ⭐⭐⭐⭐⭐
GUI 支持      | ❌        | ❌        | ✅
适用场景      | CLI应用   | 轻量CLI   | 桌面应用

================================================================
推荐建议
================================================================

🎯 OpenClaw Gateway (纯命令行):
   推荐: PKG
   理由: 平衡的体积和稳定性，资源文件支持完善

🎯 OpenClaw Desktop (带控制面板):
   推荐: Electron
   理由: 提供完整的桌面应用体验，可集成 WebChat UI

🎯 轻量级部署:
   推荐: NEXE
   理由: 文件小，适合快速部署

================================================================
常见问题
================================================================

Q: 打包失败怎么办？
A: 1. 确认 Node.js 版本 >= 22
   2. 删除 node_modules 和 package-lock.json 重试
   3. 检查网络连接（首次需要下载依赖）

Q: exe 运行报错？
A: 1. 检查 Windows Defender 是否拦截
   2. 以管理员权限运行
   3. 查看是否缺少 VC++ 运行库

Q: 打包后文件太大？
A: 1. PKG/NEXE: 使用 UPX 压缩
   2. Electron: 使用 electron-builder 的压缩选项
   3. 移除不必要的依赖

Q: 如何减小体积？
A: 1. 使用 npm prune --production 移除开发依赖
   2. 使用 webpack 打包并 tree-shaking
   3. 压缩资源文件

================================================================
下一步
================================================================

选择最适合你的方案后：

1. 将打包脚本集成到主项目
2. 添加配置文件保护机制
3. 实现首次运行向导
4. 配置自动更新（可选）
5. 创建安装程序（Inno Setup）

================================================================
